{
  "id": "64f2fb29ac23e3001c52c7e1",
  "title": "8/32にサムネをつける活動",
  "created": 1693645610,
  "updated": 1693654223,
  "lines": [
    {
      "id": "64f2fb29ac23e3001c52c7e1",
      "text": "8/32にサムネをつける活動",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c0",
      "text": "from [2023/09/02]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c1",
      "text": "8/32にサムネをつける活動",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c2",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c3",
      "text": "やれやれ。しょうがないなあ[takker.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c4",
      "text": "[ここ https://scrapbox-bundler.vercel.app?url=https://scrapbox.io/api/code/villagepump/2023%252F09%252F02/addThumbnail.ts&minify&bundle&reload&run]を押して生成されたコードを開発コンソールに貼り付けて実行する",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c5",
      "text": "　code:addThumbnail.ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c6",
      "text": "　 import { patch } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/browser/websocket/mod.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c7",
      "text": "　 ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c8",
      "text": "　 await patch(",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377c9",
      "text": "　　  \"villagepump\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ca",
      "text": "　　  \"2023/08/32\\0\\0\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377cb",
      "text": "　　  (lines) => [",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377cc",
      "text": "　　    ...lines.map((line) => line.text),",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377cd",
      "text": "　　    \"[https://gyazo.com/98e97040a8be73e69b2f7fa72f877720]\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ce",
      "text": "　　  ],",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377cf",
      "text": "　 );",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d0",
      "text": "(以下、chromeでやっていた時のログ。途中でfirefoxだと↑を実行できることに気づいた)",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d1",
      "text": "おいちょっとまてまじかこいつ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d2",
      "text": " [https://gyazo.com/22ae3af599daa0f118faba05c7e4a05b]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d3",
      "text": "❌`\\0\\0`ではなく`\\0\\0\\0`に治す",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d4",
      "text": " 正しいタイトル名にしても同じエラーが出た",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d5",
      "text": "❌リネーム前のタイトル`2023/08/32`を指定",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d6",
      "text": " 新しいページができただけでした。おわり",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d7",
      "text": "UserScriptでも直せないとなると……これはまずいな……",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d8",
      "text": "他の方法",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377d9",
      "text": " (放棄)page idを使って、直接[ScrapboxのWebSocket]に編集リクエストを送る",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377da",
      "text": "  特徴",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377db",
      "text": "　  page idなら、タイトルを使わずにアクセス可能",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377dc",
      "text": "　　　[scrapbox-userscript-std/browser/websocket]に頼らずにリクエストを送る必要がある",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377dd",
      "text": "　　　 編集コマンドを組み立てるのがめんどい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377de",
      "text": "　 実装",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377df",
      "text": "　  各種パラメタはベタ打ちする",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e0",
      "text": "　　　 `2023/08/32\\0\\0\\0`のpage idは`64f0e218eacf1b001c1044fa`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e1",
      "text": "　　　 project idは`5e2455255664e000177a46fc`",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e2",
      "text": "　　　 user idは[takker.icon]のを使う",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e3",
      "text": "　　　  他に実行したい人がいれば、各自のuser idに差し替えてください",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e4",
      "text": "　　　 ページ本文は[api/page-data/export/:projectname.json]から取得",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e5",
      "text": "　　　  `2023/08/32\\0\\0\\0`の本文を取得できるAPIは現状これしかない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e6",
      "text": "　　　  admin持っててよかった~",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e7",
      "text": "　　　code:addThumbnail-v2.ts",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e8",
      "text": "　　　 import { Socket, socketIO, wrap } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/deps/socket.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377e9",
      "text": "    import { pushCommit } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/browser/websocket/_fetch.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ea",
      "text": "    import { connect, disconnect } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/browser/websocket/socket.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377eb",
      "text": "    import { makeChanges } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/browser/websocket/makeChanges.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ec",
      "text": "    import { HeadData, pull } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/browser/websocket/pull.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ed",
      "text": "    import type { Line } from \"https://raw.githubusercontent.com/takker99/scrapbox-userscript-std/0.24.1/deps/scrapbox-rest.ts\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ee",
      "text": "    ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ef",
      "text": "    const socket = await socketIO();",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f0",
      "text": "    await connect(socket);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f1",
      "text": "    ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f2",
      "text": "    try {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f3",
      "text": "      const { request } = wrap(socket);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f4",
      "text": "      const userId = \"5ef2bdebb60650001e1280f0\";",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f5",
      "text": "      const head = {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f6",
      "text": "        lines: [\"2023/08/32\\u0000\\u0000\\u0000\",\"第35週: 日月火水木[[金]]土\",\"2023年 66.85％経過\",\"\",\"今日のn年前\",\" [2022/08/32]\",\" [2021/08/32]\",\"\",\"[biwa.icon]\",\" 少し早く起きてしまった(4:00)\",\" [鳥の詩]を聞いている\",\" iosからなら辿り着けるページ\",\"\",\"[nishio.icon]\",\" うーうー\",\"\",\"[Mijinko_SD.icon]\",\"\\t[Firefox]からならアクセスできる\",\"\",\"[nishio.icon]\",\" PCで開くとギョッとする🤯\",\"\",\"\",\"[2023/08/31]←2023/08/32→???\",\"\"],",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f7",
      "text": "        commitId: ,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f8",
      "text": "      };",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377f9",
      "text": "      const newLines = update(head.lines, head);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377fa",
      "text": "      const changes = [",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377fb",
      "text": "        ...makeChanges(head.lines, newLines, { userId, head }),",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377fc",
      "text": "      ];",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377fd",
      "text": "      await pushCommit(request, changes, {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377fe",
      "text": "        parentId: head.commitId,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b377ff",
      "text": "        projectId: \"5e2455255664e000177a46fc\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37800",
      "text": "        pageId: \"64f0e218eacf1b001c1044fa\",",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37801",
      "text": "        userId,",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37802",
      "text": "      });",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37803",
      "text": "    } finally {",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37804",
      "text": "      await disconnect(socket);",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37805",
      "text": "    }",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37806",
      "text": " export dataから本文を抽出したところで、`\"\\t[Firefox]からならアクセスできる\"`という情報を知る",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37807",
      "text": " ほんとだ、firefoxからならアクセスできるじゃん[takker.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37808",
      "text": " scriptいらなくなっちゃった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37809",
      "text": " ✅完了",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b3780a",
      "text": "  [https://gyazo.com/a101358373110ee6ff97de53188c5320]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b3780b",
      "text": "何が完了したのかしばらくわからなかったが「誰かいいサムネを頼む、バタリ」を「8/32の日記にサムネイルを追加して」と解釈されてた、ウケる[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b3780c",
      "text": "　あっ…[yosider.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b3780d",
      "text": " えっ違ったの？そんなー[takker.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b3780e",
      "text": "  勝手に勘違いしてプログラム書いちゃう恥ずかしいやつをやってしまった",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f312cde5172d00007a5cc3",
      "text": "   「やつ」というほどよくあるシチュエーションではない気がする()[yosider.icon]",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1693651662,
      "updated": 1693651712
    },
    {
      "id": "64f3154e1280f00000de3a9b",
      "text": "   業務でコード書いてる人だとありそう？[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693652302,
      "updated": 1693652323
    },
    {
      "id": "64f3155d1280f00000de3a9c",
      "text": "    先回りしてコードを書いたつもりが、結局全然使わなかったとか",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693652318,
      "updated": 1693652365
    },
    {
      "id": "64f2fb25aff09e0000b3780f",
      "text": " それはそれとして、酷いコミュニケーションミスをやらかした恐れがあるので、再発防止も兼ねて分析した",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37810",
      "text": "  [どうして「誰かいいサムネを頼む、バタリ」を「8/32の日記にサムネイルを追加して」と解釈したのか]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37811",
      "text": "　自分も8/32かと思ってた[はるひ.icon][yosider.icon][Summer498.icon]",
      "userId": "6436266c7ac3c0001bed60e6",
      "created": 1693645610,
      "updated": 1693654223
    },
    {
      "id": "64f2fb25aff09e0000b37812",
      "text": "　あっしも[切れ者.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    },
    {
      "id": "64f2fb25aff09e0000b37813",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1693645610,
      "updated": 1693645610
    }
  ]
}