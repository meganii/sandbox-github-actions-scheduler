{
  "id": "640dce75999f66001c7f5dbe",
  "title": "Scrapbox ChatGPT Connectorで遊ぶ（motoso）",
  "created": 1678626422,
  "updated": 1678626422,
  "lines": [
    {
      "id": "640dce75999f66001c7f5dbe",
      "text": "Scrapbox ChatGPT Connectorで遊ぶ（motoso）",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c16e",
      "text": "from [Scrapbox ChatGPT Connector]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c16f",
      "text": "Scrapbox ChatGPT Connectorで遊ぶ（motoso）",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c170",
      "text": "[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c171",
      "text": "　試してみる",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c172",
      "text": "　 mac",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c173",
      "text": "　 [virtualenv]をつかってからインストールした",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c174",
      "text": " 　 $ python3 -m venv env",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c175",
      "text": " 　 `Python 3.10.6 (main, Aug 30 2022, 04:58:14) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin`",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c176",
      "text": "　[https://openai.com/pricing Pricing]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c177",
      "text": "  >gpt-3.5-turbo\t$0.002 / 1K tokens",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c178",
      "text": "　　>Ada\t$0.0004 / 1K tokens",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c179",
      "text": "   Embeddingはこっちかな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17a",
      "text": "    [https://github.com/nishio/scrapbox_chatgpt_connector/blob/8c80e4b8f9aca19f7e06c7fb795aeb4103f9fa47/make_index.py#L40 ここで指定されていた]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17b",
      "text": "　　　Yes[nishio.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17c",
      "text": " API使用量の料金ページ https://platform.openai.com/account/usage",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17d",
      "text": " 課金してみよう",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17e",
      "text": " 　と思ったけど、18ドル分のfree trialがあるみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c17f",
      "text": " 　rate limitが60とPay-as-you-go扱いになっているのはこのせいかな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c180",
      "text": " 　トークンを発行してから48時間たたないと3500RPMにならないのかも",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c181",
      "text": " 　同じところでトラブってる。60から変わってくれぬ[sta.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c182",
      "text": " rate limitに達する問題",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c183",
      "text": "  catchを`sleep(2)`にしてみた",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c184",
      "text": "  　再開すると進行が途中からになるのか〜",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c185",
      "text": " 　それでも一旦rate limitに達するとcurrent 70/min -> 80/min -> 90/minと10ずつ増えてダメだった",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c186",
      "text": "  tryの中に`sleep(1)`を追加してリクエストごとに1秒待つことにした",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c187",
      "text": "  　1秒待ってるんだから、maxでも60/minしか出ない",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c188",
      "text": "　　　実際にはネットワークの往復と処理の時間がかかっているのだから60rpsより余裕で少ないはず",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c189",
      "text": "　　　なるほど。このコードで初めてAPIを使う人の方が多そうだから、しっかり待つ方をデフォルトの挙動にしておこう✅[nishio.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18a",
      "text": "　　　 自分がRate limitの対象じゃないとわかってる人はコメントアウトすれば良い",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18b",
      "text": "  またちょっと進行したけど[Scrapbox ChatGPT Connector#6409b1ae774b170000f724c4]になった",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18c",
      "text": "  放置して様子を見てみると少しつづ進んでいる",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18d",
      "text": "  >The server is currently overloaded with other requests. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if the error persists.",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18e",
      "text": "   度々これが出ているけどこれは自分のせいじゃないはず",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c18f",
      "text": "　　特にエラーが起きない。もうちょっと早くしよう。",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c190",
      "text": "　　と思ったらrate limitがでた。うーん。",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c191",
      "text": " 19:28 34%",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c192",
      "text": " 19:42 67%",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c193",
      "text": " 20:01 気づいたら終わってた",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c194",
      "text": " 待ち時間で違うことをやる",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c195",
      "text": "　[/nishio/Scrapboxのtoken/page]を計算してみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c196",
      "text": " 　[Scrapbox ChatGPT Connector#6409559caff09e0000f4fd1f]ということはどの記事も8000文字文字以下なのがベスト",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c197",
      "text": " 　https://platform.openai.com/tokenizer",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c198",
      "text": " 　 こっちはchatGPTのtokenizerだから別？",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c199",
      "text": "　　>Scrapboxを[cl100k_base]でトークナイズ",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19a",
      "text": "　　https://platform.openai.com/docs/guides/embeddings/what-are-embeddings",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19b",
      "text": "  `text-embedding-ada-002`のトークナイザーが[cl100k_base]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19c",
      "text": "　　[Scrapboxのjsonから文字数の分布を可視化する]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19d",
      "text": " 22:45 自分のScrapboxでも`make_index.py`を回し始めた",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19e",
      "text": "  23:15 273/18806。先は長い。これだと37時間かかるw",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c19f",
      "text": " 対話的にやり取りできるようにしてみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a0",
      "text": "  https://github.com/oobabooga/text-generation-webui こんなイメージ",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a1",
      "text": "  アシスタントの返事とこちらの次の発言をmessagesに積めばいいんだけど少し注意点がある[nishio.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a2",
      "text": "   [https://gyazo.com/543abd66eaeac7c63fe69aa5e0db6fe5]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a3",
      "text": "　　　最初の返事の賢さを最大限に高めたくて4096トークンの限界一般まで参考資料を詰め込んでいる",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a4",
      "text": "　　　だからこれに単純にアシスタントの返事と次の自分の発言を付け加えると限界を溢れる(1)",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a5",
      "text": "　　　素朴な対処法としては会話だけを積み直す方法(2)",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a6",
      "text": "　　　 これでチャットをするという目的は達成できるけど、この場合2回目の返事をするAIはScrapboxを読まないのでイマイチ",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a7",
      "text": "　　　[https://gyazo.com/45a1ee6486a5d21f1ed7b108a004cc78]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a8",
      "text": "　　　なので空きスペースいっぱいにScrapboxの情報を詰め込むのが良いかなと思う",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1a9",
      "text": "　　　[https://gyazo.com/ab59ccc0c3766ed1101c1982c2460494]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1aa",
      "text": "   ありがとうございます！[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1ab",
      "text": "    試す時に読み返します",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1ac",
      "text": " [EOFError: Ran out of input]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1ad",
      "text": " 何ができると便利かな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1ae",
      "text": "  自分に相談する",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1af",
      "text": " 48時間ぐらい経ったから再開と思ったらrate limit！",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b0",
      "text": "  https://platform.openai.com/account/billing/limits でクレジットカードを設定してから48hだった？え〜ん",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b1",
      "text": "  2023/3/11 19:24 設定した",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b2",
      "text": "  数時間後に回してみたら多分レートリミットとれてた。なにもわからない。",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b3",
      "text": " 学習が終わったから遊んでみよう",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b4",
      "text": " ANSWER:",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b5",
      "text": " >>>> もっとも大事な問いとは何だろう？",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b6",
      "text": " > 何をやりたいかを発見することが最も大事な問いである。",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b7",
      "text": "　これは大事[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    },
    {
      "id": "640dce75774b17000050c1b8",
      "text": "",
      "userId": "59fb21121207900012774b17",
      "created": 1678626422,
      "updated": 1678626422
    }
  ]
}