{
  "id": "5fafb7bf4278bb002143de1f",
  "title": "d3-csv-barchart-button",
  "created": 1605351386,
  "updated": 1606992239,
  "lines": [
    {
      "id": "5fafb7bf4278bb002143de1f",
      "text": "d3-csv-barchart-button",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351386,
      "updated": 1605351386
    },
    {
      "id": "5fafb7d95b98c20000156217",
      "text": "[D3.js]で棒グラフ（barchart）の描画する[アイコンボタン]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351386,
      "updated": 1605351500
    },
    {
      "id": "5fafb7da5b98c20000156218",
      "text": "テーブル記法で書かれたデータを取得し、棒グラフを描く",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156219",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621a",
      "text": "サンプルデータ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621b",
      "text": "https://www.ringodaigaku.com/study/statistics/statistics.html",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621c",
      "text": "りんごの生産量　2019年産",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621d",
      "text": "table:data",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621e",
      "text": " name\tvalue",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015621f",
      "text": " 青森県\t409800",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605791144
    },
    {
      "id": "5fafb7da5b98c20000156220",
      "text": " 長野県\t127600",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605791147
    },
    {
      "id": "5fafb7da5b98c20000156221",
      "text": " 岩手県\t45900",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605791151
    },
    {
      "id": "5fafb7da5b98c20000156222",
      "text": " 山形県\t40500",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156223",
      "text": " 福島県\t23200",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156224",
      "text": " 秋田県\t23100",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156225",
      "text": " 北海道\t8050",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156226",
      "text": " 群馬県\t8040",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156227",
      "text": " 宮城県\t2590",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156228",
      "text": " 岐阜県\t1590",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156229",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015622a",
      "text": "↓アイコン用画像",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fc8c14d5b98c20000114da4",
      "text": "[https://gyazo.com/6a10aca8b5c9e7aa0f1ffebad7c1b10d]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1606992206,
      "updated": 1606992239
    },
    {
      "id": "5fafb7da5b98c2000015622b",
      "text": "[https://gyazo.com/74e3b3d329673588a283bce4553163d8]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156230",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156231",
      "text": "code:button.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156232",
      "text": " (function () {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156233",
      "text": "   let D3js = document.getElementById('__D3js__')",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156234",
      "text": "   if (!D3js) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156235",
      "text": "     D3js = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156236",
      "text": "     D3js.id = '__D3js__'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156237",
      "text": "     D3js.src = '//cdnjs.cloudflare.com/ajax/libs/d3/6.2.0/d3.min.js'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156238",
      "text": "     document.head.appendChild(D3js);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156239",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623a",
      "text": "   let chart =  document.getElementById('__bar__')",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623b",
      "text": "   if (chart){",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623c",
      "text": "     //console.log(\"nop\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623d",
      "text": "     // リロードしてリセット",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623e",
      "text": "     location.reload(false)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015623f",
      "text": "   } else {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156240",
      "text": "     chart = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156241",
      "text": "     chart.id = '__bar__'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156242",
      "text": "     chart.src = '/api/code/villagepump/d3-csv-barchart-button/d3script.js'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351434
    },
    {
      "id": "5fafb7da5b98c20000156243",
      "text": "     //console.log(\"chart\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156244",
      "text": "     document.body.appendChild(chart);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156245",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156246",
      "text": "  })()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156247",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156248",
      "text": "code:d3script.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156249",
      "text": " const width = 800;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624a",
      "text": " const height = 500;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624b",
      "text": " const margin = 5;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624c",
      "text": " const padding = 40;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624d",
      "text": " const adj = 10;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624e",
      "text": " const svg = d3.select(\"#editor\").append(\"svg\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015624f",
      "text": " .attr(\"preserveAspectRatio\", \"xMinYMin meet\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156250",
      "text": " .attr(\"viewBox\", \"-\" + adj + \" -\"+ adj + \" \" + (width + adj) + \" \" + (height + adj*2))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156251",
      "text": " .style(\"padding\", padding)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156252",
      "text": " .style(\"margin\", margin)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156253",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156258",
      "text": " const dataset = d3.csv(`/api/table/${scrapbox.Project.name}/${encodeURIComponent(scrapbox.Page.title)}/data.csv`)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605779120
    },
    {
      "id": "5fafb7da5b98c20000156259",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625a",
      "text": " dataset.then((data)=> {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625b",
      "text": "   data.map((d)=> {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625c",
      "text": "     d.value = +d.value",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625d",
      "text": "     return d",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625e",
      "text": "   })",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015625f",
      "text": " })",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156260",
      "text": " dataset.then((data)=> {  ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156261",
      "text": "   const xScale = d3.scaleBand()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156262",
      "text": "     .rangeRound([padding, width - padding])   ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156263",
      "text": "     .padding(0.1)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156264",
      "text": "     .domain(data.map((d)=> d.name))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156265",
      "text": "   const yScale = d3.scaleLinear()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156266",
      "text": "     .domain([0, d3.max(data, (d)=> d.value)])",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156267",
      "text": "     .range([height - padding, padding])",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156268",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156269",
      "text": "   //console.log(dataset)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626a",
      "text": "   svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626b",
      "text": "     .attr(\"class\", \"axis\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626c",
      "text": "     .attr(\"transform\", \"translate(\" + 0 + \",\" + (height - padding) + \")\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626d",
      "text": "     .call(d3.axisBottom(xScale));",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626e",
      "text": "   svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015626f",
      "text": "     .attr(\"class\", \"axis\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156270",
      "text": "     .attr(\"transform\", \"translate(\" + padding + \",\" + 0 + \")\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156271",
      "text": "     .call(d3.axisLeft(yScale));",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156272",
      "text": "   dataset.then((data)=> {  ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156273",
      "text": "     svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156274",
      "text": "       .selectAll(\"rect\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156275",
      "text": "       .data(data)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156276",
      "text": "       .enter().append(\"rect\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156277",
      "text": "       .attr(\"class\", \"bar\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156278",
      "text": "       .attr(\"x\", (d)=> xScale(d.name))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156279",
      "text": "       .attr(\"y\", (d)=> yScale(d.value))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627a",
      "text": "       .attr(\"width\", xScale.bandwidth())",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627b",
      "text": "       .attr(\"height\", (d)=> height - padding - yScale(d.value))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627c",
      "text": "       .attr(\"fill\", \"steelblue\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627d",
      "text": "   })",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627e",
      "text": " })",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c2000015627f",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fb4d1ec1280f00000dd11be",
      "text": "code:button2.js",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685740,
      "updated": 1605685748
    },
    {
      "id": "5fb4d2151280f00000dd120c",
      "text": " import {installCDN} from '/api/code/villagepump/install-CDN/script.js';",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685782,
      "updated": 1605685783
    },
    {
      "id": "5fb4d2171280f00000dd120d",
      "text": "  ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685783
    },
    {
      "id": "5fb4d2171280f00000dd120e",
      "text": " export async function execute() {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685786
    },
    {
      "id": "5fb4d3b41280f00000dd122f",
      "text": " \t//const promise = fetch(`/api/table/${scrapbox.Project.name}/${encodeURIComponent(scrapbox.Page.title)}/data.csv`);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605686197,
      "updated": 1605790885
    },
    {
      "id": "5fb4d2171280f00000dd120f",
      "text": " \tawait installCDN({id: '__D3js__', src: '//cdnjs.cloudflare.com/ajax/libs/d3/6.2.0/d3.min.js'});",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685786
    },
    {
      "id": "5fb4d2171280f00000dd1210",
      "text": " \tconst {BarChart} = await import('/api/code/villagepump/d3-csv-barchart-button/barChart.js');",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605686130
    },
    {
      "id": "5fb4d2171280f00000dd1211",
      "text": " \t//const csv = await promise;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605790893
    },
    {
      "id": "5fb4d4281280f00000dd1230",
      "text": " \t//const barChart = new BarChart({id: '__bar__', csv: csv});",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605686312,
      "updated": 1605790906
    },
    {
      "id": "5fb66cb65b98c20000b6ed64",
      "text": " \tconst barChart = new BarChart({id: '__bar__'});",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790902,
      "updated": 1605790979
    },
    {
      "id": "5fb4d2171280f00000dd1212",
      "text": " \tif (barChart.remove()) {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605794932
    },
    {
      "id": "5fb4d2171280f00000dd1214",
      "text": "     \treturn;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685786
    },
    {
      "id": "5fb4d2171280f00000dd1215",
      "text": "     }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685786
    },
    {
      "id": "5fb4d2171280f00000dd1216",
      "text": " \tbarChart.draw();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605686149
    },
    {
      "id": "5fb4d2171280f00000dd1217",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685783,
      "updated": 1605685786
    },
    {
      "id": "5fb4d1ed1280f00000dd11d4",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685742,
      "updated": 1605685742
    },
    {
      "id": "5fb4d49d1280f00000dd1235",
      "text": "[- 途中まで書いて放置してあります]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605686429,
      "updated": 1605790712
    },
    {
      "id": "5fb4d4721280f00000dd1231",
      "text": " d3.jsの使い方がよくわからない",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605686387,
      "updated": 1605686430
    },
    {
      "id": "5fb66bfa5b98c20000b6ed15",
      "text": " 動くようにした",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790714,
      "updated": 1605790733
    },
    {
      "id": "5fb698661280f0000026e499",
      "text": "  ありがとうございます",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605802087,
      "updated": 1605802092
    },
    {
      "id": "5fb66c0e5b98c20000b6ed16",
      "text": " CSVファイルはd3.jsの方法で読み込む",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790734,
      "updated": 1605790807
    },
    {
      "id": "5fb695121280f00000efeec9",
      "text": " CSV fileは`BarChart`から分離させてとっかえひっかえできるようにしたほうが取り回しがしやすいと思ったのですが、どうでしょうか？",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605801235,
      "updated": 1605801342
    },
    {
      "id": "5fb695401280f00000efeeca",
      "text": " 　`csv_data.map((csv, i) => new BarChart({id: \\`__bar__${i}\\`, csv: csv}))).draw()`みたいなことができる",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605801281,
      "updated": 1605801426
    },
    {
      "id": "5fb695d21280f00000efeecc",
      "text": " 　まあそこを中途半端に外部から指定できるようにするなら、`width`,`height`なんかも外部から指定できるようにして汎用性を高めたほうが設計としてまともなのでしょうが……",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605801426,
      "updated": 1605801534
    },
    {
      "id": "5fb66c585b98c20000b6ed17",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790808,
      "updated": 1605790809
    },
    {
      "id": "5fb4d1ed1280f00000dd11d5",
      "text": "code:barChart.js",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1605685742,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed18",
      "text": " const width = 800;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed19",
      "text": " const height = 500;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1a",
      "text": " const margin = 5;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1b",
      "text": " const padding = 40;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1c",
      "text": " const adj = 10;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1d",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1e",
      "text": " export class BarChart {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed1f",
      "text": "   constructor({id}) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed20",
      "text": "     this.id = id;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed21",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed22",
      "text": "   async draw() {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed23",
      "text": "     const svg = d3.select(\"#editor\").append(\"svg\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed24",
      "text": "       .attr(\"id\", this.id)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed25",
      "text": "       .attr(\"preserveAspectRatio\", \"xMinYMin meet\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed26",
      "text": "       .attr(\"viewBox\", `-${adj} -${adj} ${width + adj} ${height + adj*2}`)       ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed27",
      "text": "       .style(\"padding\", padding)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed28",
      "text": "       .style(\"margin\", margin)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed29",
      "text": "   ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed2e",
      "text": "     const data = await d3.csv(`/api/table/${scrapbox.Project.name}/${encodeURIComponent(scrapbox.Page.title)}/data.csv`)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794424
    },
    {
      "id": "5fb66c8c5b98c20000b6ed30",
      "text": "     data.forEach(d => {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794438
    },
    {
      "id": "5fb66c8c5b98c20000b6ed31",
      "text": "       d.value = +d.value;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794441
    },
    {
      "id": "5fb66c8c5b98c20000b6ed33",
      "text": "     })",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794431
    },
    {
      "id": "5fb66c8c5b98c20000b6ed36",
      "text": "     const xScale = d3.scaleBand()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed37",
      "text": "       .rangeRound([padding, width - padding])   ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed38",
      "text": "       .padding(0.1)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed39",
      "text": "       .domain(data.map(d => d.name))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794582
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3a",
      "text": "     const yScale = d3.scaleLinear()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3b",
      "text": "       .domain([0, d3.max(data, d => d.value)])",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794584
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3c",
      "text": "       .range([height - padding, padding])",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3d",
      "text": "     svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3e",
      "text": "       .attr(\"class\", \"axis\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed3f",
      "text": "       .attr(\"transform\", `translate(0, ${height - padding})`)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794647
    },
    {
      "id": "5fb66c8c5b98c20000b6ed40",
      "text": "       .call(d3.axisBottom(xScale));",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed41",
      "text": "     svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed42",
      "text": "       .attr(\"class\", \"axis\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed43",
      "text": "       .attr(\"transform\", `translate(${padding}, 0)`)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794666
    },
    {
      "id": "5fb66c8c5b98c20000b6ed44",
      "text": "       .call(d3.axisLeft(yScale));",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794451
    },
    {
      "id": "5fb66c8c5b98c20000b6ed46",
      "text": "     svg.append(\"g\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed47",
      "text": "       .selectAll(\"rect\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed48",
      "text": "       .data(data)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed49",
      "text": "       .enter().append(\"rect\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4a",
      "text": "       .attr(\"class\", \"bar\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4b",
      "text": "       .attr(\"x\", d => xScale(d.name))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794596
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4c",
      "text": "       .attr(\"y\", d => yScale(d.value))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794597
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4d",
      "text": "       .attr(\"width\", xScale.bandwidth())",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4e",
      "text": "       .attr(\"height\", d => height - padding - yScale(d.value))",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794591
    },
    {
      "id": "5fb66c8c5b98c20000b6ed4f",
      "text": "       .attr(\"fill\", \"steelblue\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794458
    },
    {
      "id": "5fb66c8c5b98c20000b6ed52",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed53",
      "text": "\t",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605795144
    },
    {
      "id": "5fb66c8c5b98c20000b6ed59",
      "text": "   remove() {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed5a",
      "text": "     const chart = document.getElementById(this.id);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed5b",
      "text": "     if (!chart) return false;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794923
    },
    {
      "id": "5fb66c8c5b98c20000b6ed5d",
      "text": "      ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed5e",
      "text": "     // 既にchartがある場合は削除する",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed5f",
      "text": "     console.log('The chart already exists. Removing it...');",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed60",
      "text": "     $(chart).remove();",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605794750
    },
    {
      "id": "5fb67c6ddd59fe0000e0791f",
      "text": "     return true;",
      "userId": "5f3cf18043ed94001edd59fe",
      "created": 1605794926,
      "updated": 1605794926
    },
    {
      "id": "5fb66c8c5b98c20000b6ed61",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed62",
      "text": " } ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb66c8c5b98c20000b6ed63",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605790861,
      "updated": 1605790861
    },
    {
      "id": "5fb63d4e5b98c20000e4e8fd",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605778766,
      "updated": 1605778766
    },
    {
      "id": "5fafb7da5b98c20000156281",
      "text": "[*** [d3-csv-barchart-button.icon]] ←実行ボタン",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    },
    {
      "id": "5fafb7da5b98c20000156282",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1605351387,
      "updated": 1605351387
    }
  ]
}