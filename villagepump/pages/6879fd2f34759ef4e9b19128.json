{
  "id": "6879fd2f34759ef4e9b19128",
  "title": "QAP-CSV",
  "created": 1752825137,
  "updated": 1752842270,
  "lines": [
    {
      "id": "6879fd2f34759ef4e9b19128",
      "text": "QAP-CSV",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825137,
      "updated": 1752825137
    },
    {
      "id": "6879fd310000000000214813",
      "text": "[QAP]を[CSV]で表す",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825137,
      "updated": 1752825147
    },
    {
      "id": "6879fd310000000000214814",
      "text": "code:example",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825137,
      "updated": 1752825151
    },
    {
      "id": "6879fd3f0000000000214816",
      "text": " question,answer",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825151,
      "updated": 1752825154
    },
    {
      "id": "6879fd420000000000214817",
      "text": " QAPとは?,1問1答方式のQ&Aのペア",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825155,
      "updated": 1752825171
    },
    {
      "id": "6879fd3d0000000000214815",
      "text": "最初の行(`question,answer`)は固定",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825151,
      "updated": 1752825189
    },
    {
      "id": "6879fd570000000000214818",
      "text": "通常のCSV同様引用符は使える",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825175,
      "updated": 1752825198
    },
    {
      "id": "6879fd680000000000214819",
      "text": "",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752825193,
      "updated": 1752825193
    },
    {
      "id": "687a2fea000000000021481a",
      "text": "code:editlength.lua",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752838122,
      "updated": 1752838127
    },
    {
      "id": "687a40120000000000daa89f",
      "text": " local ftcsv = require 'ftcsv'",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842259,
      "updated": 1752842270
    },
    {
      "id": "687a40140000000000daa8a1",
      "text": " ",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a2",
      "text": " local function string_to_codepoint_array(s, byte)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a3",
      "text": "   local arr = {}",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a4",
      "text": "   if byte == \"[byte]\" then",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a5",
      "text": "     for i = 1, string.len(s) do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a6",
      "text": "       table.insert(arr, string.byte(s, i, i))",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a7",
      "text": "     end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a8",
      "text": "   else",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8a9",
      "text": "     for _, cp in utf8.codes(s) do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8aa",
      "text": "       table.insert(arr, cp)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ab",
      "text": "     end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ac",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ad",
      "text": "   return arr",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ae",
      "text": " end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8af",
      "text": " ",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b0",
      "text": " local function createDPTable(a, b)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b1",
      "text": "   local m = #a;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b2",
      "text": "   local n = #b;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b3",
      "text": "   local dp = {};",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b4",
      "text": "   for i = 1, m + 1 do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b5",
      "text": "     dp[i] = {};",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b6",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b7",
      "text": "   for i = 1, m + 1 do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b8",
      "text": "     dp[i][1] = i - 1;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8b9",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ba",
      "text": "   for j = 1, n + 1 do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8bb",
      "text": "     dp[1][j] = j - 1;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8bc",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8bd",
      "text": "   for i = 1, m do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8be",
      "text": "     for j = 1, n do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8bf",
      "text": "       local cost;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c0",
      "text": "       if a[i] == b[j] then",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c1",
      "text": "         cost = 0;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c2",
      "text": "       else",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c3",
      "text": "         cost = 2;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c4",
      "text": "       end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c5",
      "text": "       dp[i + 1][j + 1] = math.min(",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c6",
      "text": "         dp[i][j + 1] + 1,",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c7",
      "text": "         dp[i + 1][j] + 1,",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c8",
      "text": "         dp[i][j] + cost",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8c9",
      "text": "       );",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ca",
      "text": "     end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8cb",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8cc",
      "text": "   return dp;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8cd",
      "text": " end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8ce",
      "text": " local function levenshteinDistance(a, b)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8cf",
      "text": "   return createDPTable(a, b)[#a + 1][#b + 1];",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d0",
      "text": " end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d1",
      "text": " ",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d2",
      "text": " local qas = ftcsv.parse(\"qap-qanda.csv\")",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d3",
      "text": " ",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d4",
      "text": " local function searchQuestions(q, useBytes)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d5",
      "text": "   local qa = string_to_codepoint_array(string.lower(q), useBytes)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d6",
      "text": "   local distances = {};",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d7",
      "text": "   for i, e in ipairs(qas) do",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d8",
      "text": "     local eq = string_to_codepoint_array(string.lower(e.question), useBytes)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8d9",
      "text": "     table.insert(distances, {",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8da",
      "text": "       question = e.question,",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8db",
      "text": "       answer = e.answer,",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8dc",
      "text": "       relevance = levenshteinDistance(qa, eq) / (#qa + #eq)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8dd",
      "text": "     });",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8de",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8df",
      "text": "   table.sort(distances, function(a, b) return a.relevance < b.relevance end)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e0",
      "text": "   if #distances == 0 then",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e1",
      "text": "     return \"該当する質問が見つかりませんでした。\"",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e2",
      "text": "   end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e3",
      "text": "   local best_match = distances[1];",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e4",
      "text": "   local similarity_percentage = (1 - (best_match.relevance)) * 100;",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e5",
      "text": "   return string.format(\"%s\\n→%s\\n(類似度:%.0f%%)\",",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e6",
      "text": "     best_match.question, best_match.answer, similarity_percentage)",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e7",
      "text": " end",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e8",
      "text": " ",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a40140000000000daa8e9",
      "text": " print(searchQuestions(arg[1], arg[2]))",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752842260,
      "updated": 1752842260
    },
    {
      "id": "687a2feb000000000021481b",
      "text": "",
      "userId": "686b72ebdffe36b729b4453d",
      "created": 1752838124,
      "updated": 1752838124
    }
  ]
}