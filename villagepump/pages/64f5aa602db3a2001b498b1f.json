{
  "id": "64f5aa602db3a2001b498b1f",
  "title": "日記の書き込みからアクティブユーザー数を調べる",
  "created": 1693821538,
  "updated": 1750248211,
  "lines": [
    {
      "id": "64f5aa602db3a2001b498b1f",
      "text": "日記の書き込みからアクティブユーザー数を調べる",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821538,
      "updated": 1693821538
    },
    {
      "id": "64f5aa611280f00000d16d29",
      "text": "ふと思いついたのでメモ[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821538,
      "updated": 1693821546
    },
    {
      "id": "64f5aa691280f00000d16d2b",
      "text": "これでそれなりに正確な[アクティブユーザー]数を把握できるはず",
      "userId": "5ae7fecf7766b7001455cbd3",
      "created": 1693821546,
      "updated": 1693899111
    },
    {
      "id": "64f6d96755cbd30000f628d9",
      "text": "　途中から手動入力諦めたので応援[mtane0412.icon]",
      "userId": "5ae7fecf7766b7001455cbd3",
      "created": 1693899111,
      "updated": 1693899120
    },
    {
      "id": "64f5acb31280f00000d16d49",
      "text": "type checkとlinterは誰かやって",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693822132,
      "updated": 1693822159
    },
    {
      "id": "64f5acc51280f00000d16d4a",
      "text": " やった[takker.icon]",
      "userId": "649a24da357c4d001c518c25",
      "created": 1693822150,
      "updated": 1750248211
    },
    {
      "id": "64f6d9721280f000008639e1",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899123,
      "updated": 1693899123
    },
    {
      "id": "64f6da2a1280f00000c7c9b4",
      "text": "今実行してるけど、2020年の書き込み者数が予想以上に多い[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899307,
      "updated": 1693899329
    },
    {
      "id": "64f6da411280f00000c7c9b8",
      "text": " 8人も書き込んでいる日が最初期の頃にある",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899330,
      "updated": 1693899348
    },
    {
      "id": "64f6da531280f00000c7c9b9",
      "text": " あとから書き込んでいる人もいるだろうから、正確な数とは言えないだろうけど",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899348,
      "updated": 1693899360
    },
    {
      "id": "64f6dacf1280f00000c7c9bf",
      "text": "2021-12あたりから2桁の日がほとんどになり、2022-03以降は毎日10人以上書き込んでいる",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899472,
      "updated": 1693899513
    },
    {
      "id": "64f6da2a1280f00000c7c9b5",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899307,
      "updated": 1693899307
    },
    {
      "id": "64f6e1621280f000003c22e5",
      "text": "生成したもの",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693901154,
      "updated": 1693901158
    },
    {
      "id": "64f6e1651280f000003c22e6",
      "text": " [csv https://scrapbox.io/api/table/villagepump/日記のアクティブユーザー数/active%20users.csv]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693901158,
      "updated": 1693901160
    },
    {
      "id": "64f6e1691280f000003c22e7",
      "text": " [日記のアクティブユーザー数]に書き込んだ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693901161,
      "updated": 1693901176
    },
    {
      "id": "64f6e1771280f000003c22e8",
      "text": " 　非常に重いので注意",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693901176,
      "updated": 1693901180
    },
    {
      "id": "64f6e17b1280f000003c22e9",
      "text": " あとはこれをexcelに取り込んでヒストグラムをつくるなりしてみてください",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693901180,
      "updated": 1693901198
    },
    {
      "id": "64f6da2b1280f00000c7c9b6",
      "text": " [https://gyazo.com/76213b2c8c94eb79b8006af495784530]",
      "userId": "616ca537c25a92001e5f1e0d",
      "created": 1693899308,
      "updated": 1693910409
    },
    {
      "id": "64f705845f1e0d0000ac4e66",
      "text": "  pythonで[wogikaze.icon]",
      "userId": "616ca537c25a92001e5f1e0d",
      "created": 1693910409,
      "updated": 1693910413
    },
    {
      "id": "64f70e481280f00000943197",
      "text": "  2022年に入ってから8人前後→15人前後にシフトしてるっぽい？[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693912650,
      "updated": 1693912685
    },
    {
      "id": "64f7058a5f1e0d0000ac4e67",
      "text": "　[https://gyazo.com/c72cc1c1b9b5a0847ca41e2c22b539f7]",
      "userId": "64099110a39a5c001c8a016e",
      "created": 1693910415,
      "updated": 1750217739
    },
    {
      "id": "6852340b0000000000614a31",
      "text": "",
      "userId": "64099110a39a5c001c8a016e",
      "created": 1750217739,
      "updated": 1750217739
    },
    {
      "id": "64f6d89b1280f0000081ea7f",
      "text": "$ deno check --remote -r=https://scrapbox.io https://scrapbox.io/api/code/villagepump/日記の書き込みからアクティブユーザー数を調べる/print.ts",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693898908,
      "updated": 1693898964
    },
    {
      "id": "64f6d9121280f0000081ea81",
      "text": "https://scrapbox-bundler.vercel.app?url=https://scrapbox.io/api/code/villagepump/日記の書き込みからアクティブユーザー数を調べる/print.ts&bundle&minify&reload&run",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899027,
      "updated": 1693899058
    },
    {
      "id": "64f5aa691280f00000d16d2c",
      "text": "code:print.ts",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821546,
      "updated": 1693821553
    },
    {
      "id": "64f5aa701280f00000d16d2d",
      "text": " import { getPage } from \"../../takker/scrapbox-userscript-std/rest.ts\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821553,
      "updated": 1693821575
    },
    {
      "id": "64f6dcc31280f000003c22d9",
      "text": " import { patch } from \"../../takker/scrapbox-userscript-std/websocket.ts\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899972,
      "updated": 1693900061
    },
    {
      "id": "64f5aa8b1280f00000d16d2e",
      "text": " import { lightFormat } from \"../../takker/date-fns/lightFormat.ts\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821581,
      "updated": 1693821595
    },
    {
      "id": "64f5ab641280f00000d16d3b",
      "text": " import { addDays } from \"../../takker/date-fns/addDays.ts\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821798,
      "updated": 1693821807
    },
    {
      "id": "64f5aa9a1280f00000d16d2f",
      "text": " ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821595,
      "updated": 1693821595
    },
    {
      "id": "64f5aaa01280f00000d16d30",
      "text": " const start = new Date(2020, 8, 1);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821601,
      "updated": 1693899262
    },
    {
      "id": "64f5aafb1280f00000d16d36",
      "text": " const project = \"villagepump\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821692,
      "updated": 1693821698
    },
    {
      "id": "64f5ab971280f00000d16d3e",
      "text": " type DateStr = `${number}/${number}/${number}`;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821848,
      "updated": 1693821865
    },
    {
      "id": "64f5ab031280f00000d16d37",
      "text": " const toTitle = (date: Date): DateStr => lightFormat(date, \"yyyy/MM/dd\") as DateStr;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821700,
      "updated": 1693899019
    },
    {
      "id": "64f5aaba1280f00000d16d32",
      "text": " const now = new Date();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821627,
      "updated": 1693821666
    },
    {
      "id": "64f5aae21280f00000d16d33",
      "text": " let i = start;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821667,
      "updated": 1693821670
    },
    {
      "id": "64f5abda1280f00000d16d42",
      "text": " const data = new Map<DateStr, number>();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821915,
      "updated": 1693821948
    },
    {
      "id": "64f5aaad1280f00000d16d31",
      "text": " while (toTitle(i) !== toTitle(now)) {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821614,
      "updated": 1693821762
    },
    {
      "id": "64f5abbe1280f00000d16d40",
      "text": "   const key = toTitle(i);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821887,
      "updated": 1693821934
    },
    {
      "id": "64f5aaf11280f00000d16d34",
      "text": "   const res = await getPage(project, key);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821683,
      "updated": 1693821934
    },
    {
      "id": "64f6d9911280f000008639e3",
      "text": "   const users = res.ok && res.value.persistent ? res.value.collaborators.length + 1 : 0;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899154,
      "updated": 1693899230
    },
    {
      "id": "64f6d9821280f000008639e2",
      "text": "   console.debug(`${key}: ${users}`);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899139,
      "updated": 1693899163
    },
    {
      "id": "64f5abc91280f00000d16d41",
      "text": "   data.set(key, users);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821899,
      "updated": 1693899164
    },
    {
      "id": "64f5ab551280f00000d16d3a",
      "text": "   i = addDays(i, 1);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821782,
      "updated": 1693899115
    },
    {
      "id": "64f5aaf21280f00000d16d35",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821683,
      "updated": 1693821683
    },
    {
      "id": "64f5ab731280f00000d16d3c",
      "text": " console.debug(data);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821812,
      "updated": 1693821999
    },
    {
      "id": "64f6dd211280f000003c22da",
      "text": " ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900065,
      "updated": 1693900065
    },
    {
      "id": "64f6dd531280f000003c22dd",
      "text": " const title = \"日記のアクティブユーザー数\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900116,
      "updated": 1693900120
    },
    {
      "id": "64f6dd211280f000003c22db",
      "text": " await patch(project, title, () => [",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900066,
      "updated": 1693900126
    },
    {
      "id": "64f6dd5f1280f000003c22de",
      "text": "   title,",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900127,
      "updated": 1693900129
    },
    {
      "id": "64f6dd651280f000003c22e3",
      "text": "   \"table:active users\",",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900133,
      "updated": 1693900134
    },
    {
      "id": "64f6dd651280f000003c22e4",
      "text": "   ...[...data.entries()].map(([date, num]) => ` ${date}\\t${num}`),",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900133,
      "updated": 1693900134
    },
    {
      "id": "64f6dd4b1280f000003c22dc",
      "text": " ]);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693900107,
      "updated": 1693900138
    },
    {
      "id": "64f5aa621280f00000d16d2a",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693821540,
      "updated": 1693821540
    },
    {
      "id": "64f6da9d1280f00000c7c9bc",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899422,
      "updated": 1693899422
    },
    {
      "id": "64f6dc2d1280f00000c7c9c0",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1693899821,
      "updated": 1693899899
    }
  ]
}