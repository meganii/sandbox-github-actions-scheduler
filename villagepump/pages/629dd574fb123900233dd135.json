{
  "id": "629dd574fb123900233dd135",
  "title": "今日のn年前の無限増殖バグ",
  "created": 1654510965,
  "updated": 1694124355,
  "lines": [
    {
      "id": "629dd574fb123900233dd135",
      "text": "今日のn年前の無限増殖バグ",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654511046
    },
    {
      "id": "629dd5767838e30000bc6925",
      "text": "from [2022/06/06]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6926",
      "text": "今日のn年前",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6927",
      "text": " [2021/06/06]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6928",
      "text": "",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6929",
      "text": "今日のn年前",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc692a",
      "text": " [2021/06/06]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc692b",
      "text": "",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc692c",
      "text": "[無限増殖]する今日のn年前[Mijinko_SD.icon]",
      "userId": "60508ed36a7abc00235e90c0",
      "created": 1654510965,
      "updated": 1694124355
    },
    {
      "id": "629dd5767838e30000bc692d",
      "text": "　原因探りたいけれど、それに割り振れる[時間がない]んだよな",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc692e",
      "text": "　 同じく[takker.icon]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dde121280f0000022520c",
      "text": "　 他の方がテストしていただいた。[/icons/助かる.icon][takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1654513171,
      "updated": 1654513228
    },
    {
      "id": "629dd5767838e30000bc692f",
      "text": "　原因探索方法：このページのテキストを[pin-diary-6]の単体テストに放り込む",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6930",
      "text": "　一度テンプレート中のの空行が既存のコンテンツの空行にマッチしたことがあった[nishio.icon]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6931",
      "text": "　空行を消すと無限に増殖します[Mijinko_SD.icon]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6932",
      "text": "　\tもしかして（最初は）[空行承り太郎]が作った空行にマッチしている？",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6933",
      "text": "　\t\tテンプレートがない状態での日記ページは一番下にだけ空行がある（ことが多い）",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6934",
      "text": "今日のn年前",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6935",
      "text": " [2021/06/06]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6936",
      "text": "増えたw[nishio.icon]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6937",
      "text": "　コンテンツとテンプレートのマージ処理で、テンプレート中の空行がコンテンツの空行にマッチした場合、そこにテンプレートの内容があると判断してインデックスがそこまで進んでしまうので、この挙動が今の仕様では当然だと思う[nishio.icon]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6938",
      "text": "\t[https://gyazo.com/ae1145a2c683d6dbacc160418750b822]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6939",
      "text": "",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc693a",
      "text": "$ deno test https://scrapbox.io/api/code/villagepump/今日のn年前の無限増殖バグ/format_test5.ts",
      "userId": "59fb21121207900012774b17",
      "created": 1654510965,
      "updated": 1654514299
    },
    {
      "id": "629de27d774b1700005598fb",
      "text": " ページ切り出しで[自己言及]が間違っていたので修正[基素.icon]",
      "userId": "6292edc788348d0023bc8c23",
      "created": 1654514301,
      "updated": 1654904557
    },
    {
      "id": "629dd5767838e30000bc693b",
      "text": "code:format_test5.ts",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc693c",
      "text": " import { patchTemplate } from \"../pin-diary-5/format.ts\";",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc693d",
      "text": " import { assertEquals } from \"../pin-diary-5/deps_test.ts\";",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc693e",
      "text": " ",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc693f",
      "text": " Deno.test(\"patchTemplate()\", () => {",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6940",
      "text": "   const headers = [",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6941",
      "text": "     \"A\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6942",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6943",
      "text": "     \"B\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6944",
      "text": "   ];",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6945",
      "text": "   const lines = [",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6946",
      "text": "     \"C\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6947",
      "text": "     \"A\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6948",
      "text": "     \"B\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6949",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694a",
      "text": "   ];",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694b",
      "text": "   const footers = [",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694c",
      "text": "   \t\"footer\"",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694d",
      "text": "   ];",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694e",
      "text": "   ",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc694f",
      "text": "   assertEquals<string[]>(patchTemplate(lines, headers, footers), [",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6950",
      "text": "     \"C\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6951",
      "text": "     \"A\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6952",
      "text": "     \"B\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6953",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6954",
      "text": "     \"B\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6955",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6956",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6957",
      "text": "     \"\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6958",
      "text": "     \"footer\",",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc6959",
      "text": "   ]);",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc695a",
      "text": " });",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc695b",
      "text": "PASSED",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    },
    {
      "id": "629dd5767838e30000bc695c",
      "text": "",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1654510965,
      "updated": 1654510965
    }
  ]
}