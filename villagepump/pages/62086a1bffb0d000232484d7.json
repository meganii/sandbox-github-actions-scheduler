{
  "id": "62086a1bffb0d000232484d7",
  "title": "井戸端を開いてからの経過時間を表示するUserScript",
  "created": 1644718621,
  "updated": 1652161582,
  "lines": [
    {
      "id": "62086a1bffb0d000232484d7",
      "text": "井戸端を開いてからの経過時間を表示するUserScript",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718621,
      "updated": 1644718621
    },
    {
      "id": "62086a1f1280f00000020ab4",
      "text": "[イドバタニシ]度をみるのに使えるかも",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718623,
      "updated": 1644718648
    },
    {
      "id": "620873911280f00000c1c557",
      "text": " [https://gyazo.com/e15ffdfd2e48563ac9fed0f2090af40b]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644721041,
      "updated": 1644721106
    },
    {
      "id": "624855f1895f8c0000f3bccc",
      "text": "　これ入れてる時点でかなり重度...[dnin.icon][kuuote.icon][Mijinko_SD.icon*3]",
      "userId": "60fb0a79f3364000237838e3",
      "created": 1648907761,
      "updated": 1648925906
    },
    {
      "id": "62487a8f4bb2e20000e52121",
      "text": "　 なんとかしようとする意思がある分マシ？[kuuote.icon]",
      "userId": "5e8944948a182900174bb2e2",
      "created": 1648917136,
      "updated": 1648917146
    },
    {
      "id": "624cce371280f00000425742",
      "text": "　 そんなー[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1649200697,
      "updated": 1649200719
    },
    {
      "id": "624855ec895f8c0000f3bccb",
      "text": "",
      "userId": "6231f8cd37b7b8001d895f8c",
      "created": 1648907756,
      "updated": 1648907756
    },
    {
      "id": "620871301280f00000020b1b",
      "text": "code:js",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720433,
      "updated": 1644720436
    },
    {
      "id": "6208716b1280f00000020b20",
      "text": " await (async () => {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720492,
      "updated": 1644720500
    },
    {
      "id": "620871341280f00000020b1c",
      "text": "   const { launch } = await import(\"/api/code/villagepump/井戸端を開いてからの経過時間を表示するUserScript/script.js\");",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720436,
      "updated": 1644720578
    },
    {
      "id": "6208715b1280f00000020b1f",
      "text": "   launch();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720475,
      "updated": 1644720505
    },
    {
      "id": "620871791280f00000020b21",
      "text": " })();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720505,
      "updated": 1644720507
    },
    {
      "id": "62086a1c1280f00000020ab2",
      "text": "code:script.js",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718621,
      "updated": 1644718651
    },
    {
      "id": "62086a3b1280f00000020ab6",
      "text": " export function launch() {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718651,
      "updated": 1644718661
    },
    {
      "id": "620870f31280f00000020b15",
      "text": "   let cleanup = start();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720371,
      "updated": 1644720390
    },
    {
      "id": "620871081280f00000020b16",
      "text": "   scrapbox.addListener(\"project:changed\", () => {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720392,
      "updated": 1644720410
    },
    {
      "id": "6208711a1280f00000020b17",
      "text": "     cleanup?.();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720410,
      "updated": 1644720416
    },
    {
      "id": "6208711f1280f00000020b19",
      "text": "     cleanup = start();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720416,
      "updated": 1644720420
    },
    {
      "id": "6208711a1280f00000020b18",
      "text": "   });",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720410,
      "updated": 1644720424
    },
    {
      "id": "62086a461280f00000020ab8",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718662,
      "updated": 1644718662
    },
    {
      "id": "620871291280f00000020b1a",
      "text": " ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720426,
      "updated": 1644720426
    },
    {
      "id": "62086a5b1280f00000020aba",
      "text": " function start() {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718683,
      "updated": 1644720335
    },
    {
      "id": "62086a5a1280f00000020ab9",
      "text": "   if (scrapbox.Project.name !== \"villagepump\") return;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718682,
      "updated": 1644718682
    },
    {
      "id": "62086a731280f00000020abc",
      "text": "   const ui = makeWatch();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718707,
      "updated": 1644719236
    },
    {
      "id": "62086eeb1280f00000020af9",
      "text": "   const start = new Date();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719851,
      "updated": 1644719859
    },
    {
      "id": "62086c841280f00000020ae5",
      "text": "   const timer = setInterval(() => {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719237,
      "updated": 1644720345
    },
    {
      "id": "62086e7f1280f00000020af4",
      "text": "     ui.shadowRoot.getElementById(\"container\").textContent = formatDistance(start);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719744,
      "updated": 1644720292
    },
    {
      "id": "62086ca01280f00000020ae7",
      "text": "   }, 100);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719265,
      "updated": 1644720311
    },
    {
      "id": "620870d21280f00000020b10",
      "text": "   ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720338,
      "updated": 1644720338
    },
    {
      "id": "620870d21280f00000020b11",
      "text": "   return () => {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720338,
      "updated": 1644720349
    },
    {
      "id": "620870dd1280f00000020b12",
      "text": "     clearInterval(timer);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720349,
      "updated": 1644720360
    },
    {
      "id": "620870e81280f00000020b13",
      "text": "     ui.remove();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720360,
      "updated": 1644720365
    },
    {
      "id": "620870ed1280f00000020b14",
      "text": "   };",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720365,
      "updated": 1644720369
    },
    {
      "id": "62086a6d1280f00000020abb",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718701,
      "updated": 1644718704
    },
    {
      "id": "62086aa71280f00000020abd",
      "text": " ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718759,
      "updated": 1644718759
    },
    {
      "id": "620870441280f00000020b0f",
      "text": " const zero = (value, digit = 2) => `${value}`.padStart(digit, \"0\");",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720196,
      "updated": 1644730257
    },
    {
      "id": "62086ee01280f00000020af8",
      "text": " function formatDistance(start) {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719841,
      "updated": 1644719864
    },
    {
      "id": "62086f561280f00000020aff",
      "text": "   const duration = new Date().getTime() - start.getTime();",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719958,
      "updated": 1644719978
    },
    {
      "id": "62086f6a1280f00000020b00",
      "text": "   const milliseconds = Math.floor((duration % 1000) / 100);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719978,
      "updated": 1644720026
    },
    {
      "id": "62086f9b1280f00000020b01",
      "text": "   const seconds = Math.floor((duration % (60 * 1000)) / 1000);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720027,
      "updated": 1644720105
    },
    {
      "id": "62086fee1280f00000020b03",
      "text": "   const minutes = Math.floor((duration % (60 * 60 * 1000)) / (60 * 1000));",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720111,
      "updated": 1644720720
    },
    {
      "id": "6279fc2f1280f000000a8057",
      "text": "   const hours = Math.floor((duration - duration % (60 * 60 * 1000)) / (60 * 60 * 1000));",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1652161582,
      "updated": 1652161582
    },
    {
      "id": "6208703c1280f00000020b05",
      "text": "   ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720188,
      "updated": 1644720188
    },
    {
      "id": "62086f161280f00000020afd",
      "text": "   return `${zero(hours)}:${zero(minutes)}:${zero(seconds)}.${zero(milliseconds, 1)}`;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719895,
      "updated": 1644720287
    },
    {
      "id": "62086ef91280f00000020afb",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719865,
      "updated": 1644719865
    },
    {
      "id": "62086df41280f00000020ae9",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719604,
      "updated": 1644719606
    },
    {
      "id": "62086c781280f00000020ae4",
      "text": "UI",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719225,
      "updated": 1644719226
    },
    {
      "id": "6208970e1280f000004d0ad8",
      "text": " 局所的に[CSS]を当てたいときは[Shadow DOM]が便利[takker.icon*3]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644730126,
      "updated": 1644730152
    },
    {
      "id": "62086c761280f00000020ae2",
      "text": "code:script.js",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719222,
      "updated": 1644719223
    },
    {
      "id": "62086b061280f00000020aca",
      "text": " const id = \"イドバタニシウォッチ\";",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718854,
      "updated": 1644718863
    },
    {
      "id": "62086aa71280f00000020abe",
      "text": " function makeWatch() {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718759,
      "updated": 1644718778
    },
    {
      "id": "62086ad41280f00000020ac2",
      "text": "   if (document.getElementById(id)) return document.getElementById(id);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718804,
      "updated": 1644718875
    },
    {
      "id": "62086abb1280f00000020ac0",
      "text": "   const div = document.createElement(\"div\");",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718780,
      "updated": 1644718798
    },
    {
      "id": "62086acc1280f00000020ac1",
      "text": "   div.id = id;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718798,
      "updated": 1644718877
    },
    {
      "id": "62086b1d1280f00000020acb",
      "text": "   const shadowRoot = div.attachShadow({ mode: \"open\" });",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718878,
      "updated": 1644718893
    },
    {
      "id": "62086b2d1280f00000020acc",
      "text": "   shadowRoot.innerHTML =",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718893,
      "updated": 1644718905
    },
    {
      "id": "62086b391280f00000020ace",
      "text": " `<style>",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718905,
      "updated": 1644718911
    },
    {
      "id": "62086b571280f00000020ad2",
      "text": "   :host {",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718937,
      "updated": 1644720835
    },
    {
      "id": "62086b591280f00000020ad3",
      "text": "     position: fixed;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718938,
      "updated": 1644718944
    },
    {
      "id": "62086b601280f00000020ad5",
      "text": "     top: 50px;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718944,
      "updated": 1644718953
    },
    {
      "id": "62086b691280f00000020ad6",
      "text": "     right: 10px;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718953,
      "updated": 1644720905
    },
    {
      "id": "620871ef1280f000000b5596",
      "text": "     z-index: 1000;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720623,
      "updated": 1644720626
    },
    {
      "id": "62086bae1280f00000020ad9",
      "text": "     padding: 2px;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719022,
      "updated": 1644719027
    },
    {
      "id": "62086bb21280f00000020ada",
      "text": "     border: solid 1px black;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719027,
      "updated": 1644719046
    },
    {
      "id": "6208736b1280f00000631334",
      "text": "     border-radius: 4px;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644721004,
      "updated": 1644721011
    },
    {
      "id": "62086bce1280f00000020adb",
      "text": "     background-color: var(--page-bg, #fefefe);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719054,
      "updated": 1644719110
    },
    {
      "id": "62086bdc1280f00000020adc",
      "text": "     color: var(--page-text-color, #4a4a4a);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719068,
      "updated": 1644719134
    },
    {
      "id": "62086c511280f00000020adf",
      "text": "     font: \"Roboto\",Helvetica,Arial,\"Hiragino Sans\",sans-serif;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719185,
      "updated": 1644719209
    },
    {
      "id": "620872641280f000000b5597",
      "text": "     font-size: 1.73em;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644720741,
      "updated": 1644720744
    },
    {
      "id": "62086b5a1280f00000020ad4",
      "text": "   }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718939,
      "updated": 1644718939
    },
    {
      "id": "62086b511280f00000020ad1",
      "text": " </style>",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718930,
      "updated": 1644718934
    },
    {
      "id": "62086b3f1280f00000020acf",
      "text": " <div id=\"container\">",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718911,
      "updated": 1644719155
    },
    {
      "id": "62086c211280f00000020add",
      "text": "   00:00:00.0",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719137,
      "updated": 1644719273
    },
    {
      "id": "62086b4b1280f00000020ad0",
      "text": " </div>`",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718923,
      "updated": 1644718929
    },
    {
      "id": "62086c911280f00000020ae6",
      "text": " ",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719250,
      "updated": 1644719250
    },
    {
      "id": "62086c6c1280f00000020ae0",
      "text": "   document.body.append(div);",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719213,
      "updated": 1644719248
    },
    {
      "id": "62086c6c1280f00000020ae1",
      "text": "   return div;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644719213,
      "updated": 1644719215
    },
    {
      "id": "62086ab51280f00000020abf",
      "text": " }",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644718773,
      "updated": 1644718773
    },
    {
      "id": "620873d71280f00000c1c559",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644721112,
      "updated": 1644721112
    },
    {
      "id": "620873d71280f00000c1c55a",
      "text": "#UserScript",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644721112,
      "updated": 1644721114
    },
    {
      "id": "620873d81280f00000c1c55b",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1644721114,
      "updated": 1644721114
    }
  ]
}