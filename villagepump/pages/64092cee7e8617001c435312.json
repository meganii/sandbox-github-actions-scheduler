{
  "id": "64092cee7e8617001c435312",
  "title": "Scrapbox ChatGPT Connector",
  "created": 1678323416,
  "updated": 1678375058,
  "lines": [
    {
      "id": "64092cee7e8617001c435312",
      "text": "Scrapbox ChatGPT Connector",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678323416,
      "updated": 1678323416
    },
    {
      "id": "64094255aff09e0000b7b908",
      "text": "[https://github.com/nishio/scrapbox_chatgpt_connector GitHub - nishio/scrapbox_chatgpt_connector: ChatGPT reads Scrapbox]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328405,
      "updated": 1678328409
    },
    {
      "id": "64092ed8aff09e0000b7b8ab",
      "text": "Scrapbox ChatGPT Connectorは、ScrapboxとChatGPTを接続するためのシンプルなスクリプトです。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678323416,
      "updated": 1678327844
    },
    {
      "id": "640936ccaff09e0000b7b8c2",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678325453,
      "updated": 1678325453
    },
    {
      "id": "640936cbaff09e0000b7b8c1",
      "text": "このスクリプトは、開発者が簡単に全体像を把握し、自分のニーズに合わせてカスタマイズできるように設計されています。またこのプロジェクトの目的は、シンプルな実装を示すことであり、多様なニーズを満たすことではありません。皆さんには、ソースコードを理解し、ご自身のニーズに合わせてカスタマイズすることをお勧めします。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678325452,
      "updated": 1678325497
    },
    {
      "id": "6409401eaff09e0000b7b8ce",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327839,
      "updated": 1678327839
    },
    {
      "id": "6409401eaff09e0000b7b8cf",
      "text": "[*** インストール方法]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327839,
      "updated": 1678329325
    },
    {
      "id": "6409401faff09e0000b7b8d2",
      "text": "\tGitHubリポジトリをcloneします。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678327879
    },
    {
      "id": "6409401faff09e0000b7b8d5",
      "text": "\t以下のコマンドを実行して、必要なライブラリをインストールします。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678327880
    },
    {
      "id": "6409401faff09e0000b7b8d7",
      "text": "\t$ pip install -r requirements.txt",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678327885
    },
    {
      "id": "64094050aff09e0000b7b8f2",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327888,
      "updated": 1678327888
    },
    {
      "id": "6409401faff09e0000b7b8d8",
      "text": "[*** 使い方]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678329322
    },
    {
      "id": "6409401faff09e0000b7b8d9",
      "text": "OpenAI APIトークンを取得し、.envファイルに保存します。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678327900
    },
    {
      "id": "6409aba1774b170000f724b7",
      "text": "　トークンは https://platform.openai.com/account/api-keys から作れます",
      "userId": "59fb21121207900012774b17",
      "created": 1678355361,
      "updated": 1678355363
    },
    {
      "id": "64094069aff09e0000b7b8f4",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327914,
      "updated": 1678327914
    },
    {
      "id": "6409406aaff09e0000b7b8f5",
      "text": "code: .env",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327914,
      "updated": 1678327914
    },
    {
      "id": "6409406aaff09e0000b7b8f6",
      "text": " OPENAI_API_KEY=sk-...",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327914,
      "updated": 1678327916
    },
    {
      "id": "6409ab1a774b170000f724b2",
      "text": "",
      "userId": "59fb21121207900012774b17",
      "created": 1678355226,
      "updated": 1678355226
    },
    {
      "id": "6409451caff09e0000466fd8",
      "text": "[** インデックスを作る]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329117,
      "updated": 1678329330
    },
    {
      "id": "640945e3aff09e0000b7b914",
      "text": "サンプルに入れてある[/qualia-san]のデータを元にインデックスが作られます",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329315,
      "updated": 1678329316
    },
    {
      "id": "64094541aff09e0000466fd9",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329154,
      "updated": 1678329154
    },
    {
      "id": "6409408daff09e0000b7b8f9",
      "text": "$ python make_index.py",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327950,
      "updated": 1678327981
    },
    {
      "id": "640940adaff09e0000b7b8fa",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327982,
      "updated": 1678327982
    },
    {
      "id": "64094546aff09e0000466fda",
      "text": "下記のような出力が出ればOK",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329158,
      "updated": 1678329166
    },
    {
      "id": "6409454daff09e0000466fdb",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329166,
      "updated": 1678329166
    },
    {
      "id": "640940f7aff09e0000b7b901",
      "text": "code::",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328056,
      "updated": 1678328058
    },
    {
      "id": "640940faaff09e0000b7b903",
      "text": " % python make_index.py",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328058,
      "updated": 1678328059
    },
    {
      "id": "640940faaff09e0000b7b904",
      "text": "  97%|███████████████████████████████████████████████████████████████████████████████████████████████████▉   | 846/872 [07:06<00:10,  2.59it/s]The server is currently overloaded with other requests. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if the error persists.",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328059,
      "updated": 1678328059
    },
    {
      "id": "640940faaff09e0000b7b905",
      "text": " 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 872/872 [07:45<00:00,  1.87it/s] ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328059,
      "updated": 1678328062
    },
    {
      "id": "640940f8aff09e0000b7b902",
      "text": "この例では、途中で1回エラーが起きて、自動でリトライしています",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328056,
      "updated": 1678332955
    },
    {
      "id": "64095404aff09e0000f4fd1b",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332932,
      "updated": 1678332932
    },
    {
      "id": "64094550aff09e0000466fdc",
      "text": "[** 質問をする]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329169,
      "updated": 1678329336
    },
    {
      "id": "64094553aff09e0000466fdd",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329171,
      "updated": 1678329171
    },
    {
      "id": "640940aeaff09e0000b7b8fb",
      "text": "$ python ask.py",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327982,
      "updated": 1678327988
    },
    {
      "id": "640940b0aff09e0000b7b8fc",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327984,
      "updated": 1678327984
    },
    {
      "id": "64094555aff09e0000466fde",
      "text": "下記のような出力が出ればOK",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329174,
      "updated": 1678329182
    },
    {
      "id": "6409455eaff09e0000466fdf",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329182,
      "updated": 1678329182
    },
    {
      "id": "6409406aaff09e0000b7b8f7",
      "text": ">>>> もっとも大事な問いとは何だろう？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327914,
      "updated": 1678328001
    },
    {
      "id": "640940c0aff09e0000b7b8ff",
      "text": "> 私たち自身を知ることが最も重要な問いである。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328001,
      "updated": 1678328001
    },
    {
      "id": "640940c0aff09e0000b7b900",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328001,
      "updated": 1678328001
    },
    {
      "id": "640940baaff09e0000b7b8fd",
      "text": "[** 自分のScrapboxのデータを使う]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327995,
      "updated": 1678329340
    },
    {
      "id": "640945fdaff09e0000b7b915",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329342,
      "updated": 1678329342
    },
    {
      "id": "64094569aff09e0000466fe0",
      "text": "自分のScrapboxのデータをJSONにエクスポートする",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329194,
      "updated": 1678329267
    },
    {
      "id": "640945feaff09e0000b7b916",
      "text": " Include metadata such as line.created and line.updated.のチェックを外してExportする必要がある[blu3mo.icon][nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329343,
      "updated": 1678331405
    },
    {
      "id": "6409473f79e1130000b17cd8",
      "text": "",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678329663,
      "updated": 1678329663
    },
    {
      "id": "640945d3aff09e0000466fe2",
      "text": "コードのここの部分を書き換える",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329299,
      "updated": 1678329307
    },
    {
      "id": "64094572aff09e0000466fe1",
      "text": "code:make_index.py",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329202,
      "updated": 1678329260
    },
    {
      "id": "640945a2aff09e0000b7b90c",
      "text": " # default args for update_from_scrapbox() as sample",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329251
    },
    {
      "id": "640945a2aff09e0000b7b90d",
      "text": " # input json data from https://scrapbox.io/qualia-san/",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329251
    },
    {
      "id": "640945a2aff09e0000b7b90e",
      "text": " JSON_FILE = \"from_scrapbox/qualia-san.json\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329251
    },
    {
      "id": "640945a2aff09e0000b7b90f",
      "text": " # output file name",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329251
    },
    {
      "id": "640945a2aff09e0000b7b910",
      "text": " INDEX_FILE = \"qualia-san.pickle\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329251
    },
    {
      "id": "640945a2aff09e0000b7b911",
      "text": "code:ask.py",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329251,
      "updated": 1678329292
    },
    {
      "id": "640945ccaff09e0000b7b912",
      "text": " INDEX_FILE = \"qualia-san.pickle\"",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329292,
      "updated": 1678329292
    },
    {
      "id": "6409401faff09e0000b7b8ec",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678329348
    },
    {
      "id": "6409401faff09e0000b7b8ef",
      "text": "[** ライセンス]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678329351
    },
    {
      "id": "6409460eaff09e0000b7b917",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329359,
      "updated": 1678329359
    },
    {
      "id": "6409401faff09e0000b7b8f0",
      "text": "Scrapbox ChatGPT Connectorは、MITライセンスの下で配布されています。詳細については、LICENSEファイルをご覧ください。",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327840,
      "updated": 1678327840
    },
    {
      "id": "6409401eaff09e0000b7b8d0",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327839,
      "updated": 1678327839
    },
    {
      "id": "6409401eaff09e0000b7b8d1",
      "text": "[*** Q&Aとか雑談]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327839,
      "updated": 1678328440
    },
    {
      "id": "64094266aff09e0000b7b90a",
      "text": "ここに何でも書いて(ユーザが加筆できるREADME面白くない？)[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328423,
      "updated": 1678329600
    },
    {
      "id": "64094266aff09e0000b7b90b",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328423,
      "updated": 1678328423
    },
    {
      "id": "64094714aff09e00007513cf",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329620,
      "updated": 1678329620
    },
    {
      "id": "6409475aaff09e0000b7b919",
      "text": " [Scrapbox ChatGPT Connector]、とても気になる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409475baff09e0000b7b91a",
      "text": " Q&Aに書くにはオフトピックな気がするので、やってみたいことやアイデアをここに書く[blu3mo.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409475baff09e0000b7b91b",
      "text": "　　Q&Aではなく雑談のセクションにしたのでマージしていい？[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409475baff09e0000b7b91c",
      "text": "　　👍[blu3mo.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409475baff09e0000b7b91d",
      "text": "\t\t✅[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409475baff09e0000b7b91e",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329691,
      "updated": 1678329691
    },
    {
      "id": "6409471faff09e00007513d2",
      "text": " 「質問文で[ベクトルサーチ]」ではなく「質問文の回答を一度知識0で生成させて、その回答文を元に[ベクトルサーチ]」した方が精度が上がる、みたいな話をどこかでみた[blu3mo.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329697
    },
    {
      "id": "6409e8c4aff09e0000b07f95",
      "text": " 　上がりそう[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371013,
      "updated": 1678371013
    },
    {
      "id": "6409e8c4aff09e0000b07f96",
      "text": " 　 要するに質問文が大体の場合は短すぎて「良い」埋め込みベクトルにならないのだと思う",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371013,
      "updated": 1678371013
    },
    {
      "id": "6409e8c4aff09e0000b07f97",
      "text": " 　 　埋め込みに使われるのは[Ada]なのでそれほど頭良くないし",
      "userId": "59fb21121207900012774b17",
      "created": 1678371013,
      "updated": 1678371243
    },
    {
      "id": "6409471faff09e00007513d3",
      "text": " 　これを応用して、",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329697
    },
    {
      "id": "6409471faff09e00007513d4",
      "text": " 　 1. 質問文でベクトルサーチして、多少関連度高いページを元に回答させる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329697
    },
    {
      "id": "6409471faff09e00007513d5",
      "text": " 　 2. その回答を元にベクトルサーチして、もっと関連度高いページを元に回答させる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329697
    },
    {
      "id": "6409471faff09e00007513d6",
      "text": " 　 みたいな2 stepでやることで回答のクオリティ上がったりしないかな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329697
    },
    {
      "id": "6409e8c7aff09e0000b07f98",
      "text": " 　 なんかこれ、AIが自問自答しなから考えを深めていってる感じがあって面白いな[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371016,
      "updated": 1678371050
    },
    {
      "id": "6409471faff09e00007513da",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329632,
      "updated": 1678329632
    },
    {
      "id": "64094721aff09e00007513db",
      "text": "[/sta/俺のScrapboxをChatGPTに入れたい]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329634,
      "updated": 1678329790
    },
    {
      "id": "640949f5aff09e0000b7b920",
      "text": "\t>全くわからない。「埋め込みベクトル」「クエリー」「ベクトル」「ベクトル検索」あたり",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330357,
      "updated": 1678330374
    },
    {
      "id": "640949f5aff09e0000b7b921",
      "text": "\t描いた[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330357,
      "updated": 1678330383
    },
    {
      "id": "6409585079d3a900004a7456",
      "text": "\t\t\tたすかります[sta.icon][sta.icon]",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678334033,
      "updated": 1678334037
    },
    {
      "id": "64094a09aff09e0000b7b923",
      "text": "\t\t[https://gyazo.com/2771fdb01ea77aa72adfa69290efbed7]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330377,
      "updated": 1678330377
    },
    {
      "id": "6409819b774b170000e11762",
      "text": "\t\t　テキストをベクトルで表現したものが[埋め込みベクトル]かな？[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678344603,
      "updated": 1678344749
    },
    {
      "id": "640981ac774b170000e11763",
      "text": "\t\t　　[https://qiita.com/Hironsan/items/8f7d35f0a36e0f99752c いますぐ使える単語埋め込みベクトルのリスト - Qiita]",
      "userId": "59fb21121207900012774b17",
      "created": 1678344621,
      "updated": 1678344627
    },
    {
      "id": "640981c3774b170000e11765",
      "text": "\t\t　　[https://ja.wikipedia.org/wiki/単語の埋め込み 単語の埋め込み - Wikipedia]",
      "userId": "59fb21121207900012774b17",
      "created": 1678344643,
      "updated": 1678344645
    },
    {
      "id": "640981d8774b170000e11767",
      "text": "\t\t　　 >自然言語処理（NLP）における一連の言語モデリングおよび特徴学習手法の総称であり、単語や語句が実ベクトル空間上に位置づけられる。単語の数だけの次元を持つ空間から、はるかに低い次元を持つ連続ベクトル空間へと数学的な埋め込みが行われる",
      "userId": "59fb21121207900012774b17",
      "created": 1678344664,
      "updated": 1678344668
    },
    {
      "id": "6409889daff09e0000d45ced",
      "text": "\t\t　　 そう。1トークン1万種類くらいあるので、8000トークンの文字列は8000万次元空間の点とみなせるわけだが、これをたった1000次元程度の空間にギュッと詰め込んでしまうのが「埋め込み」",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678346397,
      "updated": 1678346580
    },
    {
      "id": "64094acb6eb4060000c5e2fd",
      "text": "\t\t自分も理解できてないので図を見てふわっと考えてみる[inajob.icon]",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678330571,
      "updated": 1678330582
    },
    {
      "id": "64094ad56eb4060000c5e2fe",
      "text": "\t\t\t質問だけだとChatGPTはあまりその内容を理解してくれないのでそれを補強しようという試み？",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678330582,
      "updated": 1678330753
    },
    {
      "id": "64094aed6eb4060000c5e2ff",
      "text": "\t\t\tどう補強するかと言うと、短い質問を膨らませた上でChatGPTに問い合わせる",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678330606,
      "updated": 1678330638
    },
    {
      "id": "64094b0d6eb4060000c5e300",
      "text": "\t\t\tどう膨らませると言うとあるScrapboxプロジェクトに記載された文書で、今回の質問と類似したものも一緒に質問とする",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678330638,
      "updated": 1678330703
    },
    {
      "id": "64094b466eb4060000c5e301",
      "text": "\t\t\t合ってるのだろうか？",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678330694,
      "updated": 1678330698
    },
    {
      "id": "64094c62aff09e0000466fed",
      "text": "\t\t\t「あまり内容を理解してくれない」というよりも、知ってて欲しいことを知らない[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330978,
      "updated": 1678331001
    },
    {
      "id": "64094cb2aff09e0000b7b924",
      "text": "    ChatGPTの学習時に使われていないデータを参考資料としてプロンプトに含めることで「これを読んで答えて」ができる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331058,
      "updated": 1678331092
    },
    {
      "id": "64094cd5aff09e0000466fef",
      "text": "    そうするとChatGPTにできない下記のデータを参考にしたやり取りができる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331094,
      "updated": 1678331114
    },
    {
      "id": "64094cb2aff09e0000b7b925",
      "text": "    　学習時に存在しなかった最新の情報",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331059,
      "updated": 1678331062
    },
    {
      "id": "64094cb2aff09e0000b7b926",
      "text": "    　電子書籍などの著作権的にインターネット上でアクセス可能にできないデータ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331059,
      "updated": 1678331062
    },
    {
      "id": "64094cb2aff09e0000b7b927",
      "text": "    　グループウェアの中の顧客コンタクト履歴のデータなど社外に公開できないもの",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331059,
      "updated": 1678331062
    },
    {
      "id": "64094d18aff09e0000b7b92b",
      "text": "    [/nishio/自分のScrapboxをChatGPTにつないだ]でKozanebaの質問を例にしているのは、ChatGPTの学習データにKozanebaの話が含まれてないから",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331161,
      "updated": 1678332112
    },
    {
      "id": "64094fa36eb4060000c5e302",
      "text": "    なるほど[inajob.icon]",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678331812,
      "updated": 1678331814
    },
    {
      "id": "64094e2cef07ca0000988ae4",
      "text": "  「この質問に回答してください。なお、回答の生成に利用するデータに、このScrapboxの内容も含んで良いです」といったことをやっているのか[fumito.icon]",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678331436,
      "updated": 1678331582
    },
    {
      "id": "64094fb56eb4060000c5e303",
      "text": "  似てる順Textが用意できるならOpenAPIを利用せずとも似たような仕組みが作れるということだろうか？[inajob.icon]",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678331829,
      "updated": 1678331855
    },
    {
      "id": "64094fdc6eb4060000c5e305",
      "text": "  \t意味を加味したテキスト類似度を出すのって大変だろうからOpenAPIを使うのは妥当だとは思いつつ、理解のために質問",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678331869,
      "updated": 1678331897
    },
    {
      "id": "64094da5aff09e0000b7b92c",
      "text": "　　　できる[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331301,
      "updated": 1678331903
    },
    {
      "id": "64094fffaff09e0000466ff7",
      "text": "　　　 「似てる順」である必然性はないので、例えばScrapboxのURLを渡して「このページと関連リンクのページを更新順に読んで」でもいい",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331903,
      "updated": 1678331960
    },
    {
      "id": "64095043aff09e0000466ff8",
      "text": "　　　 そうすると人間がScrapboxのリンクによって明示した「関連」を使って参考にする文章を選ぶようになる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331972,
      "updated": 1678331998
    },
    {
      "id": "64095112aff09e0000466ffb",
      "text": "　　　 [英語ブログの要約RSS生成の仕組み]に関連した話だと、例えばRSSの新着全部がChatGPTの4000トークンに収まるなら、全部を読ませて「最近何がホットな話題？」とか聞くことができるけど、4000トークンを超えてくると何らかの方法で選抜することが必要になる。この選抜の方法はいろいろあり得るけど、その一つの方法として埋め込みベクトルの類似度を使う方法があるというだけの話",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332179,
      "updated": 1678332511
    },
    {
      "id": "6409525faff09e0000466ffc",
      "text": "　　　 　「埋め込みベクトルの類似度を使う」はテキストの情報しか使わないのでテキストならなんでも使える、対象のデータ構造の知識があればもっと工夫のしようがある",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332512,
      "updated": 1678332551
    },
    {
      "id": "640952a9aff09e0000466ffd",
      "text": "　　　 [埋め込みベクトル]の計算がOpenAIのものである必要性は皆無",
      "userId": "59fb21121207900012774b17",
      "created": 1678332586,
      "updated": 1678338056
    },
    {
      "id": "640952c1aff09e0000466ffe",
      "text": "　　　 　対象テキストが日本語であるなら、日本語の得意なモデルを使うのもあり",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332610,
      "updated": 1678332637
    },
    {
      "id": "64095097aff09e0000466ff9",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332059,
      "updated": 1678332059
    },
    {
      "id": "64094707aff09e00007513cd",
      "text": "[* タイムアウト]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329608,
      "updated": 1678329609
    },
    {
      "id": "640933c0aff09e0000b7b8b1",
      "text": " 「APIを叩いてるけどタイムアウトしまくり」みたいな話、そもそも無料トライアルや、課金して48時間以内の新参者にはキツいリミット掛けられてるんだよね[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678324672,
      "updated": 1678329601
    },
    {
      "id": "6409f891aff09e000014b4ee",
      "text": " Rate Limit",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678375058,
      "updated": 1678375058
    },
    {
      "id": "6409f891aff09e000014b4ef",
      "text": " \t>[https://gyazo.com/df46d34c1612ea9bc585538a3af22e91]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678375058,
      "updated": 1678375058
    },
    {
      "id": "6409f891aff09e000014b4f0",
      "text": " \t\t[https://platform.openai.com/docs/guides/rate-limits/overview OpenAI API]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678375058,
      "updated": 1678375058
    },
    {
      "id": "64093f9daff09e0000b7b8c9",
      "text": " たぶんこのスクリプトで初めてChatGPT APIを試す人はこの罠にハマりまくる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678327709,
      "updated": 1678328836
    },
    {
      "id": "64094404aff09e0000466fd3",
      "text": " 一応、失敗したら1秒待ってやり直すコードにはしてあるけど、僕の環境では再現しないので試せない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328837,
      "updated": 1678328902
    },
    {
      "id": "6409acb1774b170000f724b8",
      "text": " 無課金枠だと一瞬でrate limitに達した[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678355634,
      "updated": 1678355698
    },
    {
      "id": "6409acbb774b170000f724b9",
      "text": " 　>limit reached for default-global-with-image-limits in organization org-xxx on requests per min. Limit: 60 / min. Current: 70 / min. Contact support@openai.com if you continue to have issues. Please add a payment method to your account to increase your rate limit. Visit https://platform.openai.com/account/billing to add a payment method.",
      "userId": "59fb21121207900012774b17",
      "created": 1678355643,
      "updated": 1678355648
    },
    {
      "id": "640933d2aff09e0000b7b8b6",
      "text": "　リクエストごとに1秒待つ挙動にしました[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678324690,
      "updated": 1678364164
    },
    {
      "id": "6409cdecaff09e00007e20d7",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678364140,
      "updated": 1678364140
    },
    {
      "id": "6409cdecaff09e00007e20d8",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678364140,
      "updated": 1678364140
    },
    {
      "id": "6409470eaff09e00007513ce",
      "text": "[* 値段]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329615,
      "updated": 1678329616
    },
    {
      "id": "6409446eaff09e0000466fd4",
      "text": "\tみんなが心配するのは値段だと思う[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328943,
      "updated": 1678329615
    },
    {
      "id": "64093452aff09e0000b7b8b7",
      "text": " Price",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678324818,
      "updated": 1678328958
    },
    {
      "id": "64094484aff09e0000466fd5",
      "text": " 　[/nishio]のデータでいろいろ試して10ドルいかない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678328964,
      "updated": 1678329540
    },
    {
      "id": "64093453aff09e0000b7b8b8",
      "text": "  >[https://gyazo.com/5078424fb66b40689979d7aec9abc1b6]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678324820,
      "updated": 1678328962
    },
    {
      "id": "64093456aff09e0000b7b8b9",
      "text": "　　実験過程の諸々が含まれてるので、本当はもう少し安い",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678324822,
      "updated": 1678329038
    },
    {
      "id": "640933c0aff09e0000b7b8b3",
      "text": "　　安い[blu3mo.icon*2][fumito.icon][基素.icon][yuyasurarin.icon][tkgshn.icon]",
      "userId": "5b9f8ea76ffa88001309c5f2",
      "created": 1678324673,
      "updated": 1678363223
    },
    {
      "id": "6409b2235f1e0d0000350964",
      "text": " 　　この体験ができて10$なんていかないのは本当に安いと思う[yuyasurarin.icon]",
      "userId": "616ca537c25a92001e5f1e0d",
      "created": 1678357028,
      "updated": 1678357040
    },
    {
      "id": "6409479a79e1130000b17cda",
      "text": "　サイズ感[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678329754,
      "updated": 1678330950
    },
    {
      "id": "64094bfaaff09e0000466feb",
      "text": "　　/nishioのJSONが32MB",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330875,
      "updated": 1678330897
    },
    {
      "id": "64094c2caff09e0000466fec",
      "text": "　　出来上がったベクトルインデックスは140MB",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330925,
      "updated": 1678330941
    },
    {
      "id": "6409496a79e11300002c3350",
      "text": "",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330219,
      "updated": 1678330219
    },
    {
      "id": "64093468aff09e0000b7b8bd",
      "text": "[LangChain Chat]よりインデックス作成に時間がかかっている印象[blu3mo.icon]",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678324840,
      "updated": 1678329876
    },
    {
      "id": "6409481479e11300005beb72",
      "text": "　LangChain Chatのingest.pyの処理は3000ページが15秒くらいで終わった気がする[blu3mo.icon]",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678329876,
      "updated": 1678329910
    },
    {
      "id": "640949df79e11300002c3355",
      "text": "  https://github.com/hwchase17/chat-langchain/blob/master/ingest.py",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330335,
      "updated": 1678330671
    },
    {
      "id": "64094b2e79e11300005beb79",
      "text": "　　時間かかるよねえ[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330670,
      "updated": 1678333033
    },
    {
      "id": "64095469aff09e0000f4fd1d",
      "text": "　　 どれくらい掛かるかREADMEに書きたいけど、時間測らずに放置して寝たのでどれくらい掛かるのかわからないな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333033,
      "updated": 1678333091
    },
    {
      "id": "64095463aff09e0000f4fd1c",
      "text": "　　　テキストそれぞれAPIを叩くのではなくバルクで叩く方法があるのではと思ったんだが見つけられず、とりあえず「まあ/nishioでも寝てる間に終わるからいいだろう」的な感じでリリースした",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333027,
      "updated": 1678333064
    },
    {
      "id": "64094b8679e11300005beb7b",
      "text": "   なるほど[blu3mo.icon]",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330758,
      "updated": 1678330758
    },
    {
      "id": "64094b82aff09e0000466fe9",
      "text": "　　 Scrapboxが更新された時のアップデートをどうするのかも悩みどころ[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330755,
      "updated": 1678333102
    },
    {
      "id": "64094b9aaff09e0000466fea",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330779,
      "updated": 1678330779
    },
    {
      "id": "640948eb79e11300005beb75",
      "text": "`line = re.sub(r\"https?://[^\\s]+\", \"URL\", line)`",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330091,
      "updated": 1678330112
    },
    {
      "id": "640948f279e11300005beb76",
      "text": " URLを全て\"URL\"という文字列に置き換えるのはなぜだろう[blu3mo.icon]",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330098,
      "updated": 1678330125
    },
    {
      "id": "6409490c79e11300005beb78",
      "text": " 　URLも文章の一部として使用されうる情報だと思っていたので、フィルタする理由が思いつかない",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330125,
      "updated": 1678330155
    },
    {
      "id": "64094a67aff09e0000466fe3",
      "text": " 　Twitterからの引用とかで、やたらURLが長くて、ID部分は無意味な文字列なのにたくさんトークンが消費されてるのを見てイマイチだなーと思ったので[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330471,
      "updated": 1678330552
    },
    {
      "id": "64094ab8aff09e0000466fe4",
      "text": " 　 人間が見る時もURLは「URLだなー」ぐらいにしか読まないからそれでいいだろうという判断",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330553,
      "updated": 1678330579
    },
    {
      "id": "64094b15aff09e0000466fe7",
      "text": " 　 ドメイン名を残した方がいいとか、サービスによっては消さない方がいいとかあったりするかもしれないけど細かいことを気にせずに適当にやってるだけ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678330645,
      "updated": 1678330658
    },
    {
      "id": "6409499d79e11300002c3351",
      "text": "",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678330270,
      "updated": 1678330270
    },
    {
      "id": "64094f43aff09e0000466ff3",
      "text": "類似度検索を素朴に実装しているので/nishioの",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331716,
      "updated": 1678331740
    },
    {
      "id": "64094f4eaff09e0000466ff5",
      "text": "39000チャンクに対して検索すると1秒に22000チャンクくらいの速度で1秒ちょい掛かる(Macbook Pro)[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331726,
      "updated": 1678331877
    },
    {
      "id": "64094f68aff09e0000466ff6",
      "text": " これの数倍大きい人は高速化を考える必要が出てくるだろうね",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331752,
      "updated": 1678331836
    },
    {
      "id": "64094f47aff09e0000466ff4",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678331720,
      "updated": 1678331720
    },
    {
      "id": "640950e26eb40600004437da",
      "text": "テキストの似ている順を計算するときにもOpenAIが利用できるというのを知った[inajob.icon]",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678332130,
      "updated": 1678332250
    },
    {
      "id": "640950f36eb40600004437dc",
      "text": "\t例えばScrapboxの[2-hop link]の代わりにこのベクトルを使うとかもできそう",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678332147,
      "updated": 1678332163
    },
    {
      "id": "640954eb79e1130000f1a228",
      "text": "\t　[mem]とかはそういう事をやっていそう[blu3mo.icon]",
      "userId": "5d89b1f60230ae001779e113",
      "created": 1678333163,
      "updated": 1678333178
    },
    {
      "id": "640951116eb40600004437dd",
      "text": "  [mem.nhiro.org]にその機能をつけようかな…[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678332177,
      "updated": 1678333302
    },
    {
      "id": "6409559caff09e0000f4fd1f",
      "text": "　  ちなみにChatGPTが4000トークンしか受け付けないので500トークンに刻んでインデックスを使ってるんだけど、埋め込みAPI自体は8000トークン取れる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333346,
      "updated": 1678333489
    },
    {
      "id": "64095630aff09e0000f4fd20",
      "text": "　  僕のプロジェクトの99%のページは刻まずに埋め込める",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333489,
      "updated": 1678333493
    },
    {
      "id": "64095626aff09e0000b7b92d",
      "text": "　  [/nishio/Scrapboxのtoken/page]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333479,
      "updated": 1678333479
    },
    {
      "id": "64098595774b1700003c8c1d",
      "text": "　   自分のでも計算してみたい[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678345622,
      "updated": 1678345652
    },
    {
      "id": "64095535aff09e0000f4fd1e",
      "text": "\t一度ベクトルを計算してしまえば、あとはOpenAIに聞く必要はないので、API利用のためのお金もかからない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678333238,
      "updated": 1678333238
    },
    {
      "id": "640950e46eb40600004437db",
      "text": "",
      "userId": "58442db3ee4a2400116eb406",
      "created": 1678332132,
      "updated": 1678332132
    },
    {
      "id": "64095b3faff09e0000911d3c",
      "text": "https://twitter.com/techtalkjp/status/1633669516503965696?s=20",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678334783,
      "updated": 1678346945
    },
    {
      "id": "64095b55aff09e0000911d3e",
      "text": ">tiktoken で数えるんですね！",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678334806,
      "updated": 1678334807
    },
    {
      "id": "64095b57aff09e0000911d3f",
      "text": "\t既存のライブラリはTop KのKが固定のものばっかりで、僕はChatGPT APIの上限いっぱいまで詰め込みたかったので自前実装にしました[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678334807,
      "updated": 1678334814
    },
    {
      "id": "64095b3faff09e0000911d3d",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678334783,
      "updated": 1678334783
    },
    {
      "id": "64095c9daff09e0000d45ce4",
      "text": "チャンクの結合機能はありません、今のところつける気もありません[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335134,
      "updated": 1678336972
    },
    {
      "id": "64095cabaff09e0000d45ce6",
      "text": "　from [2023/03/08]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335148,
      "updated": 1678335186
    },
    {
      "id": "64095c9faff09e0000d45ce5",
      "text": "\t [ベクトルサーチ]の[ベストマッチ]から時間軸方向にチャンクを選択するの、正しいんだろうか",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335136,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368ef5",
      "text": "  　その場合「一番関係あるところ」でスタートして、関係がだんだん減っていく流れをコンテキストとして与えることになる",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368ef6",
      "text": "  　逆では？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368ef7",
      "text": "  　一番関係あるところで終わる流れを与えた方がいいのでは？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368ef8",
      "text": "  　「前に読むのと後ろに読むのとどっちがいいかな？」と周囲を見て判断した方がいい？",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368ef9",
      "text": "  　理想を言うとスライドウィンドウの中で最も関連度の高いものを選ぶのが良さそうな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335205
    },
    {
      "id": "64095ce1aff09e0000368efa",
      "text": "  Scrapboxの構造を踏まえたインデックス作成について",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335202,
      "updated": 1678335260
    },
    {
      "id": "64095d13aff09e0000368efb",
      "text": "　　\t✅長いページは500トークン弱(行単位)で区切り、",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335252,
      "updated": 1678335263
    },
    {
      "id": "64095d13aff09e0000368efe",
      "text": "　　\t✅検索時に[* 同じページから複数取らないようにする]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335252,
      "updated": 1678335263
    },
    {
      "id": "64095d13aff09e0000368eff",
      "text": "　という感じの設計思想です",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335252,
      "updated": 1678335390
    },
    {
      "id": "64095d99aff09e0000d45ce7",
      "text": "　500トークンのチャンクは50%ずつオーバーラップしている、これがスライディングウィンドウに相当する",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335390,
      "updated": 1678335433
    },
    {
      "id": "64095d21aff09e0000368f00",
      "text": "\t同じページから複数取らないようにするのは[Maximal Marginal Relevance]的な思想",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335266,
      "updated": 1678335873
    },
    {
      "id": "64095f73aff09e0000368f01",
      "text": "　　類似度が高いものばかり取って共通点が多くなったらイマイチだから、同じページからいくつも取らない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335859,
      "updated": 1678335984
    },
    {
      "id": "64095ff0aff09e0000d45cea",
      "text": "　　一つのページからはベストな500トークンだけを取り出す",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335984,
      "updated": 1678335984
    },
    {
      "id": "64095fe3aff09e0000d45ce9",
      "text": "　　AIに「関係のありそうないくつものページを読んで考える」という活動をさせている",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335972,
      "updated": 1678336978
    },
    {
      "id": "64095f95aff09e0000d45ce8",
      "text": "　対象がScrapboxでない場合(例えば一冊の書籍とか)の場合には、オーバーラップしないように選んでからドキュメント内位置でソートするとかがいいかな",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678335894,
      "updated": 1678337059
    },
    {
      "id": "640963d3aff09e0000d45cec",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336980,
      "updated": 1678336980
    },
    {
      "id": "640962a8aff09e0000368f07",
      "text": "内積を使ってる点に関して[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336681,
      "updated": 1678336706
    },
    {
      "id": "640962a0aff09e0000368f04",
      "text": "\t>OpenAI embeddings are normalized to length 1, which means that: ",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336672,
      "updated": 1678336725
    },
    {
      "id": "640962d5aff09e0000368f08",
      "text": " > Cosine similarity can be computed slightly faster using just a dot product",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336725,
      "updated": 1678336726
    },
    {
      "id": "640962d6aff09e0000368f0a",
      "text": " > Cosine similarity and Euclidean distance will result in the identical rankings --- [doc https://platform.openai.com/docs/guides/embeddings/limitations-risks]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336726,
      "updated": 1678336743
    },
    {
      "id": "640962a0aff09e0000368f05",
      "text": "\t\t区別する意味はない",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336673,
      "updated": 1678336679
    },
    {
      "id": "640962a0aff09e0000368f06",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678336673,
      "updated": 1678336673
    },
    {
      "id": "6409880479d3a90000c402f2",
      "text": ">「似てる順」である必然性はないので、例えばScrapboxのURLを渡して「このページと関連リンクのページを更新順に読んで」でもいい [Scrapbox ChatGPT Connector#64094fffaff09e0000466ff7]",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346245,
      "updated": 1678346247
    },
    {
      "id": "6409880679d3a90000c402f3",
      "text": "\tこれはプロンプトを相当工夫しなきゃいけない、ということですか？[sta.icon]",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346248,
      "updated": 1678346267
    },
    {
      "id": "6409881a79d3a90000c402f4",
      "text": "\tたとえば",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346267,
      "updated": 1678346284
    },
    {
      "id": "6409882a79d3a90000c402f6",
      "text": "\t\t「今与えたjsonファイルの仕様を説明します。pagesにpageという概念がn件入っています。pageという概念は……」「Scrapboxでは`[]`で囲った文字列をリンクとして扱います。リンクとは……」みたいな感じで読み方を説明していく",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346284,
      "updated": 1678346353
    },
    {
      "id": "6409882c79d3a90000c402f7",
      "text": "\t\tScrapboxのjsonを解析するコードを与えた上で、「このコードから、今与えたjsonファイルの仕様を理解しなさい」みたいな命令を与える etc",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346286,
      "updated": 1678346312
    },
    {
      "id": "640987fc79d3a90000c402f1",
      "text": "　そもそもChatGPTは4000トークンしか読めないのでScrapboxからエクスポートしたJSONを直接読ませることは不可能[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678346237,
      "updated": 1678346689
    },
    {
      "id": "6409898eaff09e0000d45cee",
      "text": "　　プロンプトで頑張るのではなく、Pythonとかで「読む対象を選ぶコード」を書いて、選んでからChatGPTに渡す必要がある",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678346638,
      "updated": 1678346743
    },
    {
      "id": "64098a0879d3a90000c402f8",
      "text": "　　なるほど！[sta.icon]",
      "userId": "5a4873ab2e26fb001479d3a9",
      "created": 1678346762,
      "updated": 1678346768
    },
    {
      "id": "640989cfaff09e0000d45cef",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678346704,
      "updated": 1678346704
    },
    {
      "id": "64099e5b774b1700004e6794",
      "text": "",
      "userId": "59fb21121207900012774b17",
      "created": 1678351963,
      "updated": 1678351963
    },
    {
      "id": "64099e5b774b1700004e6795",
      "text": "[基素.icon]",
      "userId": "59fb21121207900012774b17",
      "created": 1678351963,
      "updated": 1678351964
    },
    {
      "id": "64099e5c774b1700004e6796",
      "text": "　試してみる",
      "userId": "59fb21121207900012774b17",
      "created": 1678351964,
      "updated": 1678351967
    },
    {
      "id": "6409e3da774b170000109981",
      "text": "　 mac",
      "userId": "59fb21121207900012774b17",
      "created": 1678369754,
      "updated": 1678369756
    },
    {
      "id": "6409e65d774b17000046abad",
      "text": "　 [virtualenv]をつかってからインストールした",
      "userId": "59fb21121207900012774b17",
      "created": 1678370398,
      "updated": 1678370410
    },
    {
      "id": "6409e659774b17000046abac",
      "text": " 　 $ python3 -m venv env",
      "userId": "59fb21121207900012774b17",
      "created": 1678370394,
      "updated": 1678370410
    },
    {
      "id": "6409e814774b17000046abaf",
      "text": " 　 `Python 3.10.6 (main, Aug 30 2022, 04:58:14) [Clang 13.1.6 (clang-1316.0.21.2.5)] on darwin`",
      "userId": "59fb21121207900012774b17",
      "created": 1678370837,
      "updated": 1678370842
    },
    {
      "id": "64099e60774b1700004e6798",
      "text": "　[https://openai.com/pricing Pricing]",
      "userId": "59fb21121207900012774b17",
      "created": 1678351969,
      "updated": 1678354957
    },
    {
      "id": "6409aa0d774b170000f724ac",
      "text": "  >gpt-3.5-turbo\t$0.002 / 1K tokens",
      "userId": "59fb21121207900012774b17",
      "created": 1678354957,
      "updated": 1678354959
    },
    {
      "id": "6409aa1f774b170000f724ad",
      "text": "　　>Ada\t$0.0004 / 1K tokens",
      "userId": "59fb21121207900012774b17",
      "created": 1678354976,
      "updated": 1678355031
    },
    {
      "id": "6409aa59774b170000f724af",
      "text": "   Embeddingはこっちかな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678355033,
      "updated": 1678355037
    },
    {
      "id": "6409b0f0774b170000f724c1",
      "text": "    [https://github.com/nishio/scrapbox_chatgpt_connector/blob/8c80e4b8f9aca19f7e06c7fb795aeb4103f9fa47/make_index.py#L40 ここで指定されていた]",
      "userId": "59fb21121207900012774b17",
      "created": 1678356721,
      "updated": 1678356731
    },
    {
      "id": "6409aa55774b170000f724ae",
      "text": "　　　Yes[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678355029,
      "updated": 1678355609
    },
    {
      "id": "6409ac93aff09e00007e20d4",
      "text": " API使用量の料金ページ https://platform.openai.com/account/usage",
      "userId": "59fb21121207900012774b17",
      "created": 1678355603,
      "updated": 1678357593
    },
    {
      "id": "6409ad56774b170000f724bc",
      "text": " 課金してみよう",
      "userId": "59fb21121207900012774b17",
      "created": 1678355798,
      "updated": 1678355798
    },
    {
      "id": "6409ad78774b170000f724bd",
      "text": " 　と思ったけど、18ドル分のfree trialがあるみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678355833,
      "updated": 1678355924
    },
    {
      "id": "6409adc8774b170000f724be",
      "text": " 　rate limitが60とPay-as-you-go扱いになっているのはこのせいかな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678355913,
      "updated": 1678355935
    },
    {
      "id": "6409add4774b170000f724c0",
      "text": " 　トークンを発行してから48時間たたないと3500RPMにならないのかも",
      "userId": "59fb21121207900012774b17",
      "created": 1678355924,
      "updated": 1678355952
    },
    {
      "id": "6409b465774b170000f724d0",
      "text": " rate limitに達する問題",
      "userId": "59fb21121207900012774b17",
      "created": 1678357605,
      "updated": 1678357610
    },
    {
      "id": "6409ad39774b170000f724ba",
      "text": "  catchを`sleep(2)`にしてみた",
      "userId": "59fb21121207900012774b17",
      "created": 1678355769,
      "updated": 1678357656
    },
    {
      "id": "6409b19d774b170000f724c3",
      "text": "  　再開すると進行が途中からになるのか〜",
      "userId": "59fb21121207900012774b17",
      "created": 1678356894,
      "updated": 1678356911
    },
    {
      "id": "6409b1ae774b170000f724c4",
      "text": " 　それでも一旦rate limitに達するとcurrent 70/min -> 80/min -> 90/minと10ずつ増えてダメだった",
      "userId": "59fb21121207900012774b17",
      "created": 1678356911,
      "updated": 1678356950
    },
    {
      "id": "6409b16e774b170000f724c2",
      "text": "  tryの中に`sleep(1)`を追加してリクエストごとに1秒待つことにした",
      "userId": "59fb21121207900012774b17",
      "created": 1678356847,
      "updated": 1678357674
    },
    {
      "id": "6409b4c1774b170000f724d1",
      "text": "  　1秒待ってるんだから、maxでも60/minしか出ない",
      "userId": "59fb21121207900012774b17",
      "created": 1678357697,
      "updated": 1678357698
    },
    {
      "id": "6409b4c1774b170000f724d2",
      "text": "　　　実際にはネットワークの往復と処理の時間がかかっているのだから60rpsより余裕で少ないはず",
      "userId": "59fb21121207900012774b17",
      "created": 1678357698,
      "updated": 1678357705
    },
    {
      "id": "6409cd2caff09e00007e20d5",
      "text": "　　　なるほど。このコードで初めてAPIを使う人の方が多そうだから、しっかり待つ方をデフォルトの挙動にしておこう[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678363949,
      "updated": 1678364080
    },
    {
      "id": "6409cd74aff09e00007e20d6",
      "text": "　　　 自分がRate limitの対象じゃないとわかってる人はコメントアウトすれば良い",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678364020,
      "updated": 1678364050
    },
    {
      "id": "6409b24a774b170000f724c7",
      "text": "  またちょっと進行したけど[Scrapbox ChatGPT Connector#6409b1ae774b170000f724c4]になった",
      "userId": "59fb21121207900012774b17",
      "created": 1678357066,
      "updated": 1678357123
    },
    {
      "id": "6409b278774b170000f724c8",
      "text": "  放置して様子を見てみると少しつづ進んでいる",
      "userId": "59fb21121207900012774b17",
      "created": 1678357112,
      "updated": 1678357136
    },
    {
      "id": "6409b215774b170000f724c5",
      "text": "  >The server is currently overloaded with other requests. Sorry about that! You can retry your request, or contact us through our help center at help.openai.com if the error persists.",
      "userId": "59fb21121207900012774b17",
      "created": 1678357014,
      "updated": 1678357204
    },
    {
      "id": "6409b2d4774b170000f724ca",
      "text": "   度々これが出ているけどこれは自分のせいじゃないはず",
      "userId": "59fb21121207900012774b17",
      "created": 1678357204,
      "updated": 1678357218
    },
    {
      "id": "6409b2d3774b170000f724c9",
      "text": "　　特にエラーが起きない。もうちょっと早くしよう。",
      "userId": "59fb21121207900012774b17",
      "created": 1678357203,
      "updated": 1678357394
    },
    {
      "id": "6409b3ac774b170000f724cc",
      "text": "　　と思ったらrate limitがでた。うーん。",
      "userId": "59fb21121207900012774b17",
      "created": 1678357420,
      "updated": 1678357431
    },
    {
      "id": "6409b36f774b170000f724cb",
      "text": " 19:28 34%",
      "userId": "59fb21121207900012774b17",
      "created": 1678357359,
      "updated": 1678357735
    },
    {
      "id": "6409b812774b170000f724d5",
      "text": " 19:42 67%",
      "userId": "59fb21121207900012774b17",
      "created": 1678358546,
      "updated": 1678358551
    },
    {
      "id": "6409bc78774b170000f724e2",
      "text": " 20:01 気づいたら終わってた",
      "userId": "59fb21121207900012774b17",
      "created": 1678359673,
      "updated": 1678359685
    },
    {
      "id": "6409ba6c774b170000f724d6",
      "text": " 待ち時間で違うことをやる",
      "userId": "59fb21121207900012774b17",
      "created": 1678359148,
      "updated": 1678359155
    },
    {
      "id": "6409bafd774b170000f724de",
      "text": "　[/nishio/Scrapboxのtoken/page]を計算してみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678359294,
      "updated": 1678359297
    },
    {
      "id": "6409b4df774b170000f724d4",
      "text": " 　[Scrapbox ChatGPT Connector#6409559caff09e0000f4fd1f]ということはどの記事も8000文字文字以下なのがベスト",
      "userId": "59fb21121207900012774b17",
      "created": 1678357728,
      "updated": 1678359297
    },
    {
      "id": "6409baf0774b170000f724d9",
      "text": " 　https://platform.openai.com/tokenizer",
      "userId": "59fb21121207900012774b17",
      "created": 1678359281,
      "updated": 1678359299
    },
    {
      "id": "6409baf1774b170000f724da",
      "text": " 　 こっちはchatGPTのtokenizerだから別？",
      "userId": "59fb21121207900012774b17",
      "created": 1678359282,
      "updated": 1678366023
    },
    {
      "id": "6409bac1774b170000f724d8",
      "text": "　　>Scrapboxを[cl100k_base]でトークナイズ",
      "userId": "59fb21121207900012774b17",
      "created": 1678359233,
      "updated": 1678359313
    },
    {
      "id": "6409bb12774b170000f724e0",
      "text": "　　https://platform.openai.com/docs/guides/embeddings/what-are-embeddings",
      "userId": "59fb21121207900012774b17",
      "created": 1678359315,
      "updated": 1678359353
    },
    {
      "id": "6409bb0f774b170000f724df",
      "text": "  `text-embedding-ada-002`のトークナイザーが[cl100k_base]",
      "userId": "59fb21121207900012774b17",
      "created": 1678359311,
      "updated": 1678366031
    },
    {
      "id": "6409bb63774b170000f724e1",
      "text": "　　[Scrapboxのjsonから文字数の分布を可視化する]",
      "userId": "59fb21121207900012774b17",
      "created": 1678359396,
      "updated": 1678369575
    },
    {
      "id": "6409e2f0774b170000f724e3",
      "text": " 22:45 自分のScrapboxでも`make_index.py`を回し始めた",
      "userId": "59fb21121207900012774b17",
      "created": 1678369521,
      "updated": 1678369688
    },
    {
      "id": "6409ea09774b17000046abb2",
      "text": "  23:15 273/18806。先は長い。これだと37時間かかるw",
      "userId": "59fb21121207900012774b17",
      "created": 1678371337,
      "updated": 1678371394
    },
    {
      "id": "6409e2f8774b170000f724e4",
      "text": " 対話的にやり取りできるようにしてみたい",
      "userId": "59fb21121207900012774b17",
      "created": 1678369529,
      "updated": 1678370346
    },
    {
      "id": "6409e6fa774b17000046abae",
      "text": "  https://github.com/oobabooga/text-generation-webui こんなイメージ",
      "userId": "59fb21121207900012774b17",
      "created": 1678370555,
      "updated": 1678370557
    },
    {
      "id": "6409e399774b170000109980",
      "text": " 何ができると便利かな？",
      "userId": "59fb21121207900012774b17",
      "created": 1678369690,
      "updated": 1678373991
    },
    {
      "id": "6409f467774b170000902db2",
      "text": "  自分に相談する",
      "userId": "59fb21121207900012774b17",
      "created": 1678373991,
      "updated": 1678373998
    },
    {
      "id": "6409f467774b170000902db3",
      "text": "",
      "userId": "59fb21121207900012774b17",
      "created": 1678373991,
      "updated": 1678373991
    },
    {
      "id": "6409da56ef07ca0000d7ea1f",
      "text": "[fumito.icon]",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367319,
      "updated": 1678367319
    },
    {
      "id": "6409da57ef07ca0000d7ea20",
      "text": "\t試してみた (Windows環境)",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367320,
      "updated": 1678367388
    },
    {
      "id": "6409da5fef07ca0000d7ea22",
      "text": "\t\tPythonを入れてなかったのでインストールから",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367327,
      "updated": 1678367629
    },
    {
      "id": "6409daa0ef07ca0000d7ea24",
      "text": "\t\t\thttps://www.python.org/",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367393,
      "updated": 1678367394
    },
    {
      "id": "6409dbc2ef07ca0000d7ea29",
      "text": "\t\t`$ python make_index.py`  の実行でエラー ",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367682,
      "updated": 1678367973
    },
    {
      "id": "6409dbefef07ca0000d7ea2a",
      "text": "\t\t\t`UnicodeDecodeError: 'cp932' codec can't decode byte 0x83 in position 415: illegal multibyte sequence`",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367728,
      "updated": 1678369747
    },
    {
      "id": "6409e496aff09e0000b07f8b",
      "text": "\t\t\t　おっなるほど、ちなみにPythonのバージョンはいくつですか？起動すると表示されると思います[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678369943,
      "updated": 1678370015
    },
    {
      "id": "6409e501ef07ca00001dd336",
      "text": "\t\t\t　\tPython 3.11.2でした[fumito.icon]",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678370049,
      "updated": 1678370165
    },
    {
      "id": "6409e919aff09e0000b07f9a",
      "text": "\t\t\t　\tじゃあバージョンではなくOS依存の問題っぽい、WindowsのデフォルトエンコーディングがUTF8でないことが原因なので下記の修正を入れました✅",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371098,
      "updated": 1678371300
    },
    {
      "id": "6409dc4bef07ca0000d7ea2e",
      "text": "\t\t\t引数で `uft-8`を指定するように、`make_index.py`の一部を書換え",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367819,
      "updated": 1678367881
    },
    {
      "id": "6409dc0eef07ca0000d7ea2b",
      "text": "\t\t\t\tcode:python",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367758,
      "updated": 1678368056
    },
    {
      "id": "6409dc43ef07ca0000d7ea2c",
      "text": " \t\t\t -    data = json.load(open(jsonfile))",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367811,
      "updated": 1678368058
    },
    {
      "id": "6409dc43ef07ca0000d7ea2d",
      "text": "    \t+    data = json.load(open(jsonfile, encoding='utf-8'))",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367811,
      "updated": 1678368061
    },
    {
      "id": "6409da58ef07ca0000d7ea21",
      "text": "\t\t\t\tググって見つけた対応方法だけど、これでいいのかな？",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678367320,
      "updated": 1678368169
    },
    {
      "id": "6409dda8ef07ca0000d7ea32",
      "text": "\t\t\t\tとりあえず実行してみたところ、大丈夫そう",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368169,
      "updated": 1678368176
    },
    {
      "id": "6409dd6aef07ca0000d7ea31",
      "text": "\t\tインデックスができるまで待機中",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368107,
      "updated": 1678368261
    },
    {
      "id": "6409e07eef07ca0000d7ea33",
      "text": "\t\t\t終わっていた",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368894,
      "updated": 1678368947
    },
    {
      "id": "6409e0a8ef07ca0000d7ea35",
      "text": "\t\tうまく動いた",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368936,
      "updated": 1678368940
    },
    {
      "id": "6409e0d0ef07ca0000d7ea37",
      "text": "\t\t\tめちゃくちゃ楽しいな......",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368976,
      "updated": 1678369594
    },
    {
      "id": "6409dd46ef07ca0000d7ea30",
      "text": "",
      "userId": "5e11de5979b9010017ef07ca",
      "created": 1678368070,
      "updated": 1678368070
    },
    {
      "id": "6409ea08aff09e0000b07f9b",
      "text": "初めて試す人は埋め込みが遅いからクオリアさんよりもっと小さいテスト用JSONがあると良い[nishio.icon]",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371337,
      "updated": 1678371374
    },
    {
      "id": "6409ea2faff09e0000b07f9d",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371375,
      "updated": 1678371375
    },
    {
      "id": "6409ea2faff09e0000b07f9e",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371375,
      "updated": 1678371375
    },
    {
      "id": "6409ea12aff09e0000b07f9c",
      "text": "",
      "userId": "582e63d27c56960011aff09e",
      "created": 1678371346,
      "updated": 1678371346
    }
  ]
}