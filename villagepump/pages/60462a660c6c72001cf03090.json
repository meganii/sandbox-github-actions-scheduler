{
  "id": "60462a660c6c72001cf03090",
  "title": "Scrapboxをスプレッドシートのように使う",
  "created": 1615211113,
  "updated": 1627787610,
  "lines": [
    {
      "id": "60462a660c6c72001cf03090",
      "text": "Scrapboxをスプレッドシートのように使う",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211113,
      "updated": 1615211113
    },
    {
      "id": "604c486a8ee92a0000fca041",
      "text": "[/masui/ScrapCalc]を参照 ",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615612011,
      "updated": 1615612020
    },
    {
      "id": "604c486a8ee92a0000fca042",
      "text": "",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615612011,
      "updated": 1615612011
    },
    {
      "id": "60462bbf8ee92a0000e8af45",
      "text": " `[% 式]` という表記を利用する [増井俊之.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211456,
      "updated": 1627753616
    },
    {
      "id": "60462be18ee92a0000e8af47",
      "text": " 下のブックマークレットを呼ぶと式が計算される",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211490,
      "updated": 1615211545
    },
    {
      "id": "60462beb8ee92a0000e8af48",
      "text": " 式が変数名だけのときはその値が表示される",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211499,
      "updated": 1615211516
    },
    {
      "id": "604633561280f000005d80aa",
      "text": " 面白い発想ですね[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615213397,
      "updated": 1615213416
    },
    {
      "id": "6046336a1280f000005d80ab",
      "text": "  応用して何かに使えないかな",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615213417,
      "updated": 1615213468
    },
    {
      "id": "604633bb8ee92a00000e51d4",
      "text": "  普通に[スプレッドシート]的に使えますが、面白い応用はあるかも [増井俊之.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615213499,
      "updated": 1615215118
    },
    {
      "id": "6046eb2d8ee92a00009cb5a4",
      "text": " テキストエディタをスプレッドシートみたいに使うというのは[Boomborg計算 http://nicosia.is.s.u-tokyo.ac.jp/boomborg/boomborg-keisan-j.html]のアイデアです",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615260461,
      "updated": 1615260597
    },
    {
      "id": "6046ebdf8ee92a00009cb5a5",
      "text": "  [http://nicosia.is.s.u-tokyo.ac.jp/pub/staff/hagiya/boomborg/keisan/zeikin.txt 税金計算の例]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615260640,
      "updated": 1615260646
    },
    {
      "id": "60462bbf8ee92a0000e8af46",
      "text": "",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211456,
      "updated": 1615211456
    },
    {
      "id": "60462a688ee92a00007ba969",
      "text": " [% a = 100]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211113,
      "updated": 1627753567
    },
    {
      "id": "60462a698ee92a00007ba96a",
      "text": " [% b = 200]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211113,
      "updated": 1627753569
    },
    {
      "id": "60462a708ee92a00007ba96b",
      "text": " [% a + b]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211120,
      "updated": 1627753571
    },
    {
      "id": "60462c808ee92a00002df496",
      "text": " [%  Date()]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615211648,
      "updated": 1627787415
    },
    {
      "id": "60462cd68ee92a00001dc0d6",
      "text": " ブックマークレットを呼ぶと以下のように表示される",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211735,
      "updated": 1615213539
    },
    {
      "id": "60462c9b8ee92a0000c2c9fd",
      "text": " [https://gyazo.com/thumb/400/43be983bf4fa5f2108d7cebe019d8dc4.png]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211675,
      "updated": 1615213570
    },
    {
      "id": "60462a8e8ee92a0000fa644f",
      "text": "",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211151,
      "updated": 1615211151
    },
    {
      "id": "60462a8f8ee92a0000fa6450",
      "text": " 以下のブックマークレットを起動すると結果が表示される",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211151,
      "updated": 1615213754
    },
    {
      "id": "604634ba8ee92a00000e51d6",
      "text": " UserScriptにしても大丈夫なのだろうか?",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615213755,
      "updated": 1615213768
    },
    {
      "id": "604634dd1280f000005d80bd",
      "text": "  `eval()`が気になります",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615213788,
      "updated": 1615213910
    },
    {
      "id": "604635251280f000005d80bf",
      "text": "   何でも実行できてしまう",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615213860,
      "updated": 1615213870
    },
    {
      "id": "604635301280f000005d80c0",
      "text": "  最も、`eval()`を使う以外に方法がなさそうなので、目をつぶるしかなさそうです",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615213871,
      "updated": 1615234543
    },
    {
      "id": "604677df1280f00000703a07",
      "text": "   前に実行したscriptの変数とscopeを共有しなくていいなら、[Function()]を代わりに使うことが出来ます",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615230944,
      "updated": 1615549949
    },
    {
      "id": "6046360a1280f000005d80c5",
      "text": " Userscriptにするとしたら、どういうUIがいいかな[takker.icon]",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615214089,
      "updated": 1615214170
    },
    {
      "id": "604636201280f000005d80c6",
      "text": "  PageMenuを押して実行が一番便利かな",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615214111,
      "updated": 1615214140
    },
    {
      "id": "6046363d1280f000005d80c7",
      "text": "   mobile端末からでも使える",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615214140,
      "updated": 1615214160
    },
    {
      "id": "6046365d1280f000005d80cf",
      "text": "  popup menuなら、選択範囲だけ実行させることも可能",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615214172,
      "updated": 1615214197
    },
    {
      "id": "604639aee5172d00008dec63",
      "text": " [js-script-button]に似てる？[yosider.icon]",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615215020,
      "updated": 1615228500
    },
    {
      "id": "604639e6e5172d00008dec64",
      "text": " \tコードブロックじゃなくインラインなところが違うか",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615215075,
      "updated": 1615215093
    },
    {
      "id": "60466e411280f0000032513d",
      "text": " コードブロックだと[/miyamonz/コードブロックのjsを実行するUserScript]というのがあった",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615228482,
      "updated": 1615228508
    },
    {
      "id": "604639fde5172d00008dec65",
      "text": "",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615215098,
      "updated": 1615215099
    },
    {
      "id": "60462ac48ee92a0000647b31",
      "text": "code:boomborg.js",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b32",
      "text": " javascript:(() => {",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615213239
    },
    {
      "id": "60462ac58ee92a0000647b33",
      "text": "     for(const expr of document.getElementsByClassName('deco-\\%')){",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615211205,
      "updated": 1627784688
    },
    {
      "id": "60462ac58ee92a0000647b34",
      "text": "         const text = expr.innerText;",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615213254
    },
    {
      "id": "60462ac58ee92a0000647b35",
      "text": "         if(/=/.test(text)){",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615214044
    },
    {
      "id": "60462ac58ee92a0000647b36",
      "text": "             eval(decodeURI(text));",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b37",
      "text": "      \t} else {",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615213156
    },
    {
      "id": "60462ac58ee92a0000647b39",
      "text": "             let processed = false;",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b3a",
      "text": "             for(let e of expr.children){",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b3b",
      "text": "                 if(processed){",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b3c",
      "text": "                     e.innerHTML = \"\";",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60466ef01280f0000032513e",
      "text": "                     continue;",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1615228657,
      "updated": 1615228659
    },
    {
      "id": "60462ac58ee92a0000647b3d",
      "text": "                 }",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b3f",
      "text": "                 e.innerHTML =",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615228668
    },
    {
      "id": "60462ac58ee92a0000647b40",
      "text": "                   `<span style=\"font-style:italic;font-weight:bold;\">${eval(decodeURI(text))}</span>`;",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615228668
    },
    {
      "id": "60462ac58ee92a0000647b42",
      "text": "                 processed = true;",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615228668
    },
    {
      "id": "60462ac58ee92a0000647b44",
      "text": "             }",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b45",
      "text": "         }",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b46",
      "text": "     }",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b47",
      "text": " })()",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615211205
    },
    {
      "id": "60462ac58ee92a0000647b48",
      "text": "`'deco-\\\\='`だと動かなかったので`'deco-\\='`に変更[yosider.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615211205,
      "updated": 1615214936
    },
    {
      "id": "60463940e5172d00006bb8b2",
      "text": " あれ? 私のとこではそれだと動かなくて... [増井俊之.icon]",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615214910,
      "updated": 1615260414
    },
    {
      "id": "6046f19ce5172d000044d7d8",
      "text": "  あれれ…Chromeなのですが[yosider.icon]",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615262110,
      "updated": 1615262148
    },
    {
      "id": "6046f3fc8ee92a00000e51d9",
      "text": "  `getElementsByClassName()`じゃなかったからかな? [増井俊之.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615262717,
      "updated": 1615262736
    },
    {
      "id": "6046f40f8ee92a00000e51da",
      "text": "   `document.querySelectorAll('.deco-\\\\=')` としてた",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615262735,
      "updated": 1615262899
    },
    {
      "id": "6046f487e5172d00000c5f36",
      "text": "   \tほんとですね、[document.querySelectorAll()]ならこちらじゃないとマッチしませんね[yosider.icon]",
      "userId": "5c30ba88e98efe0017e5172d",
      "created": 1615262855,
      "updated": 1615262891
    },
    {
      "id": "6046f4498ee92a00000e51dc",
      "text": "",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615262794,
      "updated": 1615262794
    },
    {
      "id": "60481b128ee92a00009cb5ab",
      "text": " [ScrapCalc]と呼ぶことにします [増井俊之.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615338258,
      "updated": 1615346820
    },
    {
      "id": "60481aee8ee92a00009cb5a8",
      "text": "[おま環]だろうけど、Firefoxでは動かなかった...[air34n.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615338223,
      "updated": 1615365174
    },
    {
      "id": "60488c398ee92a00000ddc3a",
      "text": " UserScriptの方はどうですかね ? [増井俊之.icon]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615367225,
      "updated": 1615367236
    },
    {
      "id": "60488c528ee92a00000ddc3b",
      "text": "  [Page MenuからScrapCalcを動かす]",
      "userId": "566fa156776c9b11008ee92a",
      "created": 1615367251,
      "updated": 1615367251
    },
    {
      "id": "6048840b1d860a000090b3e8",
      "text": "  UserScriptの方は動きました[air34n.icon]",
      "userId": "58e5636749e40700111d860a",
      "created": 1615365132,
      "updated": 1615390078
    },
    {
      "id": "6048e5891d860a0000d1ecbf",
      "text": "  それはよかた [増井俊之.icon]",
      "userId": "58e5636749e40700111d860a",
      "created": 1615390079,
      "updated": 1615612002
    },
    {
      "id": "61060c111280f00000edad0b",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1627787561,
      "updated": 1627787561
    },
    {
      "id": "610604d01280f00000967b33",
      "text": "",
      "userId": "5ef2bdebb60650001e1280f0",
      "created": 1627784403,
      "updated": 1627784403
    }
  ]
}