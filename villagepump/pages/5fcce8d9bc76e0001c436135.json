{
  "id": "5fcce8d9bc76e0001c436135",
  "title": "viz-script-button",
  "created": 1607264496,
  "updated": 1607333157,
  "lines": [
    {
      "id": "5fcce8d9bc76e0001c436135",
      "text": "viz-script-button",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264496,
      "updated": 1607264496
    },
    {
      "id": "5fcce8f05b98c20000fd414e",
      "text": "viz.jsのスクリプトを動かす[アイコンボタン]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264496,
      "updated": 1607333157
    },
    {
      "id": "5fcce8f15b98c20000fd414f",
      "text": "[Graphviz] の 記法が使える",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4150",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4151",
      "text": "[https://github.com/mdaines/viz.js GitHub - mdaines/viz.js: A hack to put Graphviz on the web.]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4152",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcdf5025b98c20000d02fc9",
      "text": "[/forum-jp/Graphvizのコードを画像化したい]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607333123,
      "updated": 1607333125
    },
    {
      "id": "5fcdf5025b98c20000d02fca",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607333123,
      "updated": 1607333123
    },
    {
      "id": "5fcce8f15b98c20000fd4153",
      "text": "↓実行ボタン",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4154",
      "text": "[viz-script-button.icon]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4155",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4156",
      "text": "↓アイコン用画像",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4157",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4158",
      "text": "[https://gyazo.com/91b5ced64196f95f1c650da5f3455bda]",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4159",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415a",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415b",
      "text": "viz.js と full.render.js を読み込む必要がる",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415c",
      "text": "この部分を洗練させたい",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415d",
      "text": "code:button.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415e",
      "text": " (()=> {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd415f",
      "text": "   let VIZjs = document.getElementById('__VIZjs__')",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4160",
      "text": "   if (!VIZjs) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4161",
      "text": "     VIZjs = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4162",
      "text": "     VIZjs.id = '__VIZjs__'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4163",
      "text": "     VIZjs.src = '//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4164",
      "text": "     document.head.appendChild(VIZjs);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4165",
      "text": "     let FRjs = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4166",
      "text": "     FRjs.id = '__FRjs__'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4167",
      "text": "     FRjs.src = '//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4168",
      "text": "     document.head.appendChild(FRjs);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4169",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416a",
      "text": "   let vscript =  document.getElementById('__VIZsc__')",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416b",
      "text": "   if (vscript){",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416c",
      "text": "     console.log(\"nop\")",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416d",
      "text": "     // リロードしてリセット",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416e",
      "text": "     location.reload(false)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd416f",
      "text": "   } else {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4170",
      "text": "     vscript = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4171",
      "text": "     vscript.id = '__VIZsc__'",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4172",
      "text": "     vscript.type = 'module';",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4173",
      "text": "     vscript.src = `https://scrapbox.io/api/code/${scrapbox.Project.name}/${encodeURIComponent(scrapbox.Page.title)}/vizScript.js`",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4174",
      "text": "     document.body.appendChild(vscript);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4175",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4176",
      "text": "  })()",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4177",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4178",
      "text": "code:button2.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4179",
      "text": " import {installCDN} from '/api/code/villagepump/install-CDN/script.js';",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417a",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417b",
      "text": " export async function execute() {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417c",
      "text": "   await installCDN({id: '__VIZjs__', src: '//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js'});",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417d",
      "text": "   await installCDN({id: '__FRjs__', src: '//cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js'});",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417e",
      "text": "   const vscript = new VIZScript('__VIZsc__');",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd417f",
      "text": "   if(vscript.hasScript()) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4180",
      "text": "     vscript.remove();",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4181",
      "text": "     alert(\"removed\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4182",
      "text": "     location.reload(false)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4183",
      "text": "     return;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4184",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4185",
      "text": "   vscript.draw();",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4186",
      "text": " }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4187",
      "text": " class VIZScript {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4188",
      "text": "   constructor({id}) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4189",
      "text": " \tthis.id = id;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418a",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418b",
      "text": "   draw() {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418c",
      "text": "     let vscript = document.createElement(\"script\");",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418d",
      "text": "     vscript.id = this.id;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418e",
      "text": "     vscript.type = 'module';",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd418f",
      "text": "     vscript.src = `https://scrapbox.io/api/code/${scrapbox.Project.name}/${encodeURIComponent(scrapbox.Page.title)}/vizScript.js` ;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4190",
      "text": "     document.body.appendChild(vscript);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4191",
      "text": "   } ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4192",
      "text": "   hasScript() { return document.getElementById(this.id) !== null;}",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4193",
      "text": "        ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4194",
      "text": "   remove() {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4195",
      "text": "     const vscript = document.getElementById(this.id);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4196",
      "text": "     if (!vscript) return;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4197",
      "text": "     // 既にscriptがある場合は削除する",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4198",
      "text": "     vscript.parentNode.removeChild(vscript);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd4199",
      "text": "     console.log('The script already exists. Removing it...');",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419a",
      "text": "   }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419b",
      "text": " }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419c",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419d",
      "text": "code:vizScript.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419e",
      "text": "  const graph = `",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd419f",
      "text": "  digraph {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a0",
      "text": "   a -> b;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a1",
      "text": "   a -> c;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a2",
      "text": "   b -> d;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a3",
      "text": "  }",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a4",
      "text": "  `;",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a5",
      "text": " ",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a6",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a7",
      "text": "code:vizScript.js",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a8",
      "text": " const viz = new Viz();",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41a9",
      "text": " viz.renderSVGElement(graph)",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41aa",
      "text": " .then(function(element) {",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41ab",
      "text": "   const editor = document.getElementById('editor');",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41ac",
      "text": "   editor.appendChild(element);",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41ad",
      "text": " });",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41ae",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41af",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41b0",
      "text": "[viz-script-button.icon] ←実行ボタン",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41b1",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41b2",
      "text": "#UserScript",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41b3",
      "text": "#icon-button",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    },
    {
      "id": "5fcce8f15b98c20000fd41b4",
      "text": "",
      "userId": "5b5e7121417cf700145b98c2",
      "created": 1607264497,
      "updated": 1607264497
    }
  ]
}